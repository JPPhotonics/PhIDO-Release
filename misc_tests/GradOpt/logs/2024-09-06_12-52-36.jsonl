{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725619964.8883505",
    "msecs": "888.0",
    "relativeCreated": "11579.216718673706",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:None\nQuery: Is this a single academic article, and not a dissertation or collection of papers (single_article)?\nIs the main topic of this article about integrated photonic circuits (topic_photonic)?\nIf yes, find the photonic components that are used on the chip. \nReturn a concise list of these photonic components, if any (components_list).\nAnswer in YAML following template:\nsingle_article: True/False\ntopic_photonic: True/False\ncomponents_list:\n  - component1\n  - component2\n  - ...\nOnly output a YAML text without any preamble like quotations. \n  \nINPUT ARTICLE:\nA Hybrid Solid-State Beam Scanner for FMCW \nLiDAR Application \nZhaoyang Zhang,1 Xufeng Du,2 Zhiyan Zhou,1 Qikai Huang,1 Qiang Zhang,3 \nTingge Dai,1 Hui Yu,1 Yuehai Wang,1 and Jianyi Yang 1, * \n1 College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou 310027, China \n2 Guofeng Electronics, Manzhouli 021400, China \n3 Zhejiang Lab, Hangzhou 311121, China \nAuthor e-mail address: yangjy@zju.edu.cn \nAbstract: We demonstrate a hybrid solid-state beam scanner based on a Si3N4 switching array. \nTwo-dimensional beam steering with a 14.3\u00b0\u00d79.9\u00b0\n field of view and FMCW ranging operation at a \ndistance of 7.4 m are achieved.   \n1. Introduction\nDue to the huge demand brought by the promotion of autonomous driving and robotics, light detection and ranging \n(LiDAR) technology has attracted extensive attention in the past decade. To date, various types of on-chip beam \nscanners have been demonstrated to replace mechanical scanners [1\u20134]. Optical phased arrays on silicon-on-\ninsulator (SOI) provide an attractive method to perform non-mechanical beam steering [5\u20137]. However, it still \nsuffers from the extensive and complex active phase shifting, in order to calibrate the stochastic phase errors in the \narrayed waveguides [8]. Focal plane switching arrays based on silicon photonics platform and MEMS platform \nemerge as an alternative approach due to the advantages of compact size, low power consumption and simple \ncontrol [9,10]. Among them, beam scanners based on Mach\u2013Zehnder interferometer (MZI) abandon the \nmechanical moving parts entirely. In addition, ultra high-speed and low-loss optical switches can be obtained by \nintegrating novel materials with high Pockels coefficients [11,12]. In this work, we demonstrate a hybrid solid-\nstate beam scanner based on a Si3N4 switching array and a blazed grating. The output beam is steered across the \n14.3\u00b0 \u00d7 9.9\u00b0 field of view (FOV) with beam divergence less than 0.1\u00b0. In addition, a ranging distance of 7.4 m is \nachieved by combining the proposed beam scanner and the frequency-modulated continuous-wave (FMCW) \ntechnology. \nFig. 1.  (a) Microscope photograph of the fabricated Si3N4 switching array chip. (b) Schematic of the hybrid \nsolid-state beam scanner. (c) Intensity cuts in \u03b8-direction of 32 separate beams at different angles. (d) \nMeasured beam scanning result and the theoretical value of the transmission grating in \uf06a-direction versus the \nworking wavelength. (e) Two-dimensional beam scanning observed on the screen. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\u00a9 2023 The Author(s)\n \nFig. 2. (a) Experimental setup of the FMCW ranging operation using the beam scanner. (b) The spectrum of \nthe PLL based FMCW synthesizer. (c) and (d) are the time domain and frequency domain signals \ncorresponding to the target of 7.4 m, respectively. (e) Measured beat frequency versus the ranging distance. \n \n2.  Device Fabrication and Beam Steering \nAn optical micrograph of the 32-channel Si3N4 switching array with an overall footprint of 2.2 mm \u00d7 10 mm is \nshown in Fig. 1 (a). The device is fabricated on an 8-inch wafer with a 400 nm-thick PECVD Si3N4 layer by \nAdvanced Micro Foundry. Light is coupled into the chip from a grating coupler. Next, a five-layer binary tree \nformed by cascaded Si3N4 MZI switches routes the incident beam to 32 channels. Thermo-optics phase shifters are \nused to control the on-chip light path. The edge emitters are etched facet inverse tapers with a tip width of 300 nm. \nThe pitch between two adjacent edge emitters is 65 \u00b5m. The schematic of the solid-state beam scanner is depicted in \nFig. 1 (b). Beam emitted from the chip is collimated by an aspherical lens (f = 8.0 mm, NA = 0.5). Then the output \nbeam is aligned to a lithographically patterned diffraction transmission grating (966.18 lines/mm) at the Littrow \nangle. Next, a 45\u00b0 aluminum-coated mirror fixed in the 3D printed mount is used to deflect the beam direction. To \ncharacterize the beam steering, we set a screen in front of the beam scanner at a distance of 2.1 m. An infrared \ncamera records the beam profile on the screen. As shown in Fig. 1 (c), the main beam is steered across a range of \n14.3\u00b0 in \u03b8-direction by toggling the optical switches. Though phase errors still exist in the Si3N4 photonic integrated \ncircuit, the initial phase calibration takes only a few minutes. This problem can be further solved by the real-time \nfeedback control with on-chip power monitors. The angular step between two adjacent points is 0.46\u00b0, which can be \nmuch decreased by enlarging the array size in our future work. A beam steering range of 9.9\u00b0 in the \uf06a-direction is \nachieved by tuning the wavelength from 1500 nm to 1610 nm, as shown in Fig. 1 (d). The steering efficiency thus is \naround 0.09\u00b0/ nm, which is higher than the on-chip Si3N4 grating antenna in [13]. The demand of wideband tunable \nlaser with narrow linewidth still hinders further cost reduction. However, it can be solved by using the massive \ncoherent laser based on the microcomb in [14]. Finally, two-dimensional beam steering is achieved by wavelength \ntuning and switching of channels, as shown in Fig 1. (e). The beam divergency in both directions is measured to be \n< 0.1\u00b0. \n \n3.  FMCW Ranging Operation \nThe setup for FMCW ranging operation is shown in Fig. 2 (a). The FMCW RF signal is provided by the frequency \nsynthesizer based on a fractional-N phased-locked loop (PLL). It generates sawtooth chirps with a period of 1 ms. \nThe chirp range is approximately from 6 GHz to 9 GHz, as shown in Fig. 2 (b). Then the chirped laser light is \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\ngenerated by using an optical single sideband modulator. A 3dB optical power splitter distributes the output of the \nmodulator into two components: one goes straight to the balance detector as the local reference light, and the \nremaining is amplified by an Erbium-doped fiber amplifier (EDFA) as the input of the Si3N4 chip. The backscattered \nlight from the target is collected by a fiber collimator and routed to the balanced detector. An oscillograph records \nthe output of the balanced photodetector and performs real-time FFT analysis. Representative beat signals in the \ntime domain and the frequency domain of a target at 7.4m away are depicted in Fig. 2 (c) and Fig. 2 (d), respectively. \nFigure 2 (e) shows the measured beat frequency when the target distance varies from 0.7 m to 7.4 m. A strong linear \ncorrelation between the beat frequency and the target distance is observed. The slope of the linear fit is around 20.54 \nkHz/m, which is in line with the chirp slope of \u223c 3 MHz/\u00b5s. It is worth noting that the intercept at the frequency \naxis comes from the fixed fiber length difference. The chirp slope can be further increased by using FMCW PLL ICs \n[15], in order to speed up the ranging operation. \n \n4.  Conclusion \nIn conclusion, we demonstrate a hybrid solid-state beam scanner based on the Si3N4 switching array. The \ncombination of the edge emitter and the external transmission grating improves the beam quality as well as the \noptical emission efficiency. Besides, no prism lens with special designs and mechanical moving components exist in \nthe easily implemented beam scanner. Two-dimensional beam steering with a FOV of 14.3\u00b0 \u00d7 9.9\u00b0 is achieved by \nswitch toggling and wavelength tuning. Furthermore, FMCW ranging operation up to 7.4 m is also presented by \nusing the Si3N4 switching array as the transmitter. Our measurements indicate that the proposed hybrid solid-state \nbeam scanner is a scalable and flexible solution for the next-generation FMCW LiDAR. \n \n5.  References \n \n[1] D. N. Hutchison, J. Sun, J. K. Doylend, R. Kumar, J. Heck, W. Kim, C. T. Phare, A. Feshali, and H. Rong, \u201cHigh-resolution aliasing-free \noptical beam steering\u201d, Optica 3, 887\u2013890 (2016). \n[2] H. Ito, Y. Kusunoki, J. Maeda, D. Akiyama, N. Kodama, H. Abe, R. Tetsuya, and T. Baba, \u201cWide beam steering by slow-light waveguide \ngratings and a prism lens\u201d, Optica 7, 47\u201352 (2020). \n[3] J. Park, B. G. Jeong, S. I. Kim, D. Lee, J. Kim, C. Shin, C. B. Lee, T. Otsuka, J. Kyoung, S. Kim, K.-Y. Yang, Y.-Y. Park, J. Lee, I. Hwang, J. \nJang, S. H. Song, M. L. Brongersma, K. Ha, S.-W. Hwang, H. Choo, and B. L. Choi, \u201cAll-solid-state spatial light modulator with independent \nphase and amplitude control for three-dimensional LiDAR applications\u201d, Nat. Nanotechnol. 16, 69\u201376 (2021). \n[4] R. Li, S. Hu, X. Gu, and F. Koyama, \u201cSolid-state slow-light beam scanner with ultra-large field of view and high resolution\u201d, J. Light. \nTechnol. 40, 1855\u20131861 (2022). \n[5] C. V. Poulton, M. J. Byrd, P. Russo, E. Timurdogan, M. Khandaker, D. Vermeulen, and M. R. Watts, \u201cLong-range LiDAR and free-space \ndata communication with high-performance optical phased arrays\u201d, IEEE J. Sel. Top. Quantum Electron. 25, 1\u20138 (2019). \n[6] Y. Li, B. Chen, Q. Na, Q. Xie, M. Tao, L. Zhang, Z. Zhi, Y. Li, X. Liu, X. Luo, G. Lo, F. Gao, X. Li, and J. Song, \u201cWide-steering-angle high-\nresolution optical phased array\u201d, Photon. Res. 9, 2511\u20132518 (2021). \n[7] W. Xu, Y. Guo, X. Li, C. Liu, L. Lu, J. Chen, and L. Zhou, \u201cFully integrated solid-state lidar transmitter on a multi-layer silicon-nitride-on-\nsilicon photonic platform\u201d, J. Light. Technol. pp. 1\u201310 (2022). \n[8] T. Komljenovic and P. Pintus, \u201cOn-chip calibration and control of optical phased arrays\u201d, Opt. Express 26, 3199\u20133210 (2018). \n[9] X. Zhang, K. Kwon, J. Henriksson, J. Luo, and M. C. Wu, \u201cA large-scale microelectromechanical-systems-based silicon photonics LiDAR\u201d, \nNature 603, 253\u2013258 (2022). \n[10] C. Rogers, A. Y. Piggott, D. J. Thomson, R. F. Wiser, I. E. Opris, S. A. Fortune, A. J. Compston, A. Gondarenko, F. Meng, X. Chen, G. T. \nReed, and R. Nicolaescu, \u201cA universal 3D imaging sensor on a silicon photonics platform\u201d, Nature 590, 256\u2013261 (2021). \n[11] F. Eltes, C. Mai, D. Caimi, M. Kroh, Y. Popoff, G. Winzer, D. Petousi, S. Lischke, J. E. Ortmann, L. Czornomaz, L. Zimmermann, J. Fom-\npeyrine, and S. Abel, \u201cA BaTiO3-based electro-optic Pockels modulator monolithically integrated on an advanced silicon photonics platform\u201d, J. \nLight. Technol. 37, 1456\u20131462 (2019). \n[12] K. Alexander, J. P. George, J. Verbist, K. Neyts, B. Kuyken, D. Van Thourhout, and J. Beeckman, \u201cNanophotonic Pockels modulators on a \nsilicon nitride platform\u201d, Nat. Commun. 9, 3444 (2018). \n[13] C. Li, X. Cao, K. Wu, G. Qiu, M. Cai, G. Zhang, X. Li, and J. Chen, \u201cBlind zone-suppressed hybrid beam steering for solid-state LiDAR\u201d, \nPhoton. Res. 9, 1871\u20131880 (2021). \n[14] J. Riemensberger, A. Lukashchuk, M. Karpov, W. Weng, E. Lucas, J. Liu, and T. J. Kippenberg, \u201cMassively parallel coherent laser ranging \nusing a soliton microcomb\u201d, Nature 581, 164\u2013170 (2020). \n[15] H. Shanan, D. Dalton, V. Chillara, and P. Dato, \u201cA 9-to-12GHz coupled-RTWO FMCW ADPLL with 97fs rms jitter, -120dBc/Hz PN at \n1MHz offset, and with retrace time of 12.5 ns and 2 \u03bcs chirp settling time\u201d, in 2022 IEEE International Solid- State Circuits Conference (ISSCC), \nvol. 65 (2022), pp. 146\u2013148. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\n\nResponse: single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Edge emitters\n  - Diffraction transmission grating\n  - Fiber collimator\n  - Balanced photodetector",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725619966.5087245",
    "msecs": "508.0",
    "relativeCreated": "13199.590682983398",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- \n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback.\nQuery: single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Edge emitters\n  - Diffraction transmission grating\n  - Fiber collimator\n  - Balanced photodetector\nResponse: - The list includes \"Fiber collimator,\" which is typically an off-chip component.\n- \"Edge emitters\" might also be considered off-chip depending on the context.\n- The rest of the components accurately represent photonic components on the chip.\n- No other photonic components seem to be missing based on the provided list.\n\nOverall, the list should exclude off-chip components like the \"Fiber collimator\" and potentially \"Edge emitters\" to accurately represent only the on-chip photonic components.",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm prompt",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "209",
    "funcName": "_backward_through_llm_base",
    "created": "1725619966.509723",
    "msecs": "509.0",
    "relativeCreated": "13200.589179992676",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "You will give feedback to a variable with the following role: <ROLE> The yaml file to optimize </ROLE>. Here is an evaluation of the variable using a language model:\n\n<LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- \n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Edge emitters\n  - Diffraction transmission grating\n  - Fiber collimator\n  - Balanced photodetector </LM_INPUT>\n\n<LM_OUTPUT> - The list includes \"Fiber collimator,\" which is typically an off-chip component.\n- \"Edge emitters\" might also be considered off-chip depending on the context.\n- The rest of the components accurately represent photonic components on the chip.\n- No other photonic components seem to be missing based on the provided list.\n\nOverall, the list should exclude off-chip components like the \"Fiber collimator\" and potentially \"Edge emitters\" to accurately represent only the on-chip photonic components. </LM_OUTPUT>\n\n<OBJECTIVE_FUNCTION>Your goal is to give feedback and criticism to the variable given the above evaluation output. Our only goal is to improve the above metric, and nothing else. </OBJECTIVE_FUNCTION>\n\nWe are interested in giving feedback to the The yaml file to optimize for this conversation. Specifically, give feedback to the following span of text:\n\n<VARIABLE> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - (...) transmission grating\n  - Fiber collimator\n  - Balanced photodetector </VARIABLE>\n\nGiven the above history, describe how the The yaml file to optimize could be improved to improve the <OBJECTIVE_FUNCTION>. Be very creative, critical, and intelligent.\n\n",
    "message": "_backward_through_llm prompt"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm gradient",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "211",
    "funcName": "_backward_through_llm_base",
    "created": "1725619970.2885642",
    "msecs": "288.0",
    "relativeCreated": "16979.430437088013",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The evaluation highlights that \"Fiber collimator\" is typically an off-chip component. Removing this entry will ensure the list accurately represents only on-chip photonic components.\n\n2. **Clarify Context for Edge Emitters**: The evaluation mentions that \"Edge emitters\" might be considered off-chip depending on the context. To avoid ambiguity, either remove this component or provide a clear context within the YAML file that specifies it is an on-chip component if applicable.\n\n3. **Ensure Exclusivity to Photonic Components**: Double-check that all listed components are strictly photonic and relevant to the chip. This will prevent any non-photonic or irrelevant components from being included.\n\n4. **Verify Completeness**: Although the evaluation states no other photonic components seem to be missing, it is prudent to cross-reference with the source article to ensure all relevant on-chip photonic components are included.\n\n5. **Consistent Terminology**: Ensure that the terminology used for each component is consistent with the source article to avoid any misinterpretation or confusion.\n\nBy addressing these points, the YAML file will better align with the objective of accurately summarizing the photonic components presented in the input article, focusing exclusively on on-chip components.",
    "message": "_backward_through_llm gradient"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent prompt for update",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "165",
    "funcName": "_update_prompt",
    "created": "1725619970.2895615",
    "msecs": "289.0",
    "relativeCreated": "16980.427742004395",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "prompt": "Here is the role of the variable you will improve: <ROLE>The yaml file to optimize</ROLE>.\n\nThe variable is the text within the following span: <VARIABLE> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - (...) transmission grating\n  - Fiber collimator\n  - Balanced photodetector </VARIABLE>\n\nHere is the context and feedback we got for the variable:\n\n<CONTEXT>Here is a conversation:\n\n<CONVERSATION><LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- \n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Edge emitters\n  - Diffraction transmission grating\n  - Fiber collimator\n  - Balanced photodetector </LM_INPUT>\n\n<LM_OUTPUT> - The list includes \"Fiber collimator,\" which is typically an off-chip component.\n- \"Edge emitters\" might also be considered off-chip depending on the context.\n- The rest of the components accurately represent photonic components on the chip.\n- No other photonic components seem to be missing based on the provided list.\n\nOverall, the list should exclude off-chip components like the \"Fiber collimator\" and potentially \"Edge emitters\" to accurately represent only the on-chip photonic components. </LM_OUTPUT>\n\n</CONVERSATION>\n\nThis conversation is potentially part of a larger system. The output is used as response from the language model\n\nHere is the feedback we got for The yaml file to optimize in the conversation:\n\n<FEEDBACK>To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The evaluation highlights that \"Fiber collimator\" is typically an off-chip component. Removing this entry will ensure the list accurately represents only on-chip photonic components.\n\n2. **Clarify Context for Edge Emitters**: The evaluation mentions that \"Edge emitters\" might be considered off-chip depending on the context. To avoid ambiguity, either remove this component or provide a clear context within the YAML file that specifies it is an on-chip component if applicable.\n\n3. **Ensure Exclusivity to Photonic Components**: Double-check that all listed components are strictly photonic and relevant to the chip. This will prevent any non-photonic or irrelevant components from being included.\n\n4. **Verify Completeness**: Although the evaluation states no other photonic components seem to be missing, it is prudent to cross-reference with the source article to ensure all relevant on-chip photonic components are included.\n\n5. **Consistent Terminology**: Ensure that the terminology used for each component is consistent with the source article to avoid any misinterpretation or confusion.\n\nBy addressing these points, the YAML file will better align with the objective of accurately summarizing the photonic components presented in the input article, focusing exclusively on on-chip components.</FEEDBACK>\n\n</CONTEXT>\n\nImprove the variable (The yaml file to optimize) using the feedback provided in <FEEDBACK> tags.\nSend the improved variable in the following format:\n\n<IMPROVED_VARIABLE>{the improved variable}</IMPROVED_VARIABLE>\n\nSend ONLY the improved variable between the <IMPROVED_VARIABLE> tags, and nothing else.",
    "message": "TextualGradientDescent prompt for update"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent optimizer response",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "179",
    "funcName": "step",
    "created": "1725619972.000445",
    "msecs": "0.0",
    "relativeCreated": "18691.31112098694",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "optimizer.response": "<IMPROVED_VARIABLE>\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Diffraction transmission grating\n  - Balanced photodetector\n</IMPROVED_VARIABLE>",
    "message": "TextualGradientDescent optimizer response"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent updated text",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "187",
    "funcName": "step",
    "created": "1725619972.000445",
    "msecs": "0.0",
    "relativeCreated": "18691.31112098694",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "parameter.value": "single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Diffraction transmission grating\n  - Balanced photodetector",
    "message": "TextualGradientDescent updated text"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725620065.2803102",
    "msecs": "280.0",
    "relativeCreated": "111971.17638587952",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:None\nQuery: Is this a single academic article, and not a dissertation or collection of papers (single_article)?\nIs the main topic of this article about integrated photonic circuits (topic_photonic)?\nIf yes, find the photonic components that are used on the chip. \nReturn a concise list of these photonic components, if any (components_list).\nAnswer in YAML following template:\nsingle_article: True/False\ntopic_photonic: True/False\ncomponents_list:\n  - component1\n  - component2\n  - ...\nOnly output a YAML text without any preamble like quotations. \n  \nINPUT ARTICLE:\nA Hybrid Solid-State Beam Scanner for FMCW \nLiDAR Application \nZhaoyang Zhang,1 Xufeng Du,2 Zhiyan Zhou,1 Qikai Huang,1 Qiang Zhang,3 \nTingge Dai,1 Hui Yu,1 Yuehai Wang,1 and Jianyi Yang 1, * \n1 College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou 310027, China \n2 Guofeng Electronics, Manzhouli 021400, China \n3 Zhejiang Lab, Hangzhou 311121, China \nAuthor e-mail address: yangjy@zju.edu.cn \nAbstract: We demonstrate a hybrid solid-state beam scanner based on a Si3N4 switching array. \nTwo-dimensional beam steering with a 14.3\u00b0\u00d79.9\u00b0\n field of view and FMCW ranging operation at a \ndistance of 7.4 m are achieved.   \n1. Introduction\nDue to the huge demand brought by the promotion of autonomous driving and robotics, light detection and ranging \n(LiDAR) technology has attracted extensive attention in the past decade. To date, various types of on-chip beam \nscanners have been demonstrated to replace mechanical scanners [1\u20134]. Optical phased arrays on silicon-on-\ninsulator (SOI) provide an attractive method to perform non-mechanical beam steering [5\u20137]. However, it still \nsuffers from the extensive and complex active phase shifting, in order to calibrate the stochastic phase errors in the \narrayed waveguides [8]. Focal plane switching arrays based on silicon photonics platform and MEMS platform \nemerge as an alternative approach due to the advantages of compact size, low power consumption and simple \ncontrol [9,10]. Among them, beam scanners based on Mach\u2013Zehnder interferometer (MZI) abandon the \nmechanical moving parts entirely. In addition, ultra high-speed and low-loss optical switches can be obtained by \nintegrating novel materials with high Pockels coefficients [11,12]. In this work, we demonstrate a hybrid solid-\nstate beam scanner based on a Si3N4 switching array and a blazed grating. The output beam is steered across the \n14.3\u00b0 \u00d7 9.9\u00b0 field of view (FOV) with beam divergence less than 0.1\u00b0. In addition, a ranging distance of 7.4 m is \nachieved by combining the proposed beam scanner and the frequency-modulated continuous-wave (FMCW) \ntechnology. \nFig. 1.  (a) Microscope photograph of the fabricated Si3N4 switching array chip. (b) Schematic of the hybrid \nsolid-state beam scanner. (c) Intensity cuts in \u03b8-direction of 32 separate beams at different angles. (d) \nMeasured beam scanning result and the theoretical value of the transmission grating in \uf06a-direction versus the \nworking wavelength. (e) Two-dimensional beam scanning observed on the screen. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\u00a9 2023 The Author(s)\n \nFig. 2. (a) Experimental setup of the FMCW ranging operation using the beam scanner. (b) The spectrum of \nthe PLL based FMCW synthesizer. (c) and (d) are the time domain and frequency domain signals \ncorresponding to the target of 7.4 m, respectively. (e) Measured beat frequency versus the ranging distance. \n \n2.  Device Fabrication and Beam Steering \nAn optical micrograph of the 32-channel Si3N4 switching array with an overall footprint of 2.2 mm \u00d7 10 mm is \nshown in Fig. 1 (a). The device is fabricated on an 8-inch wafer with a 400 nm-thick PECVD Si3N4 layer by \nAdvanced Micro Foundry. Light is coupled into the chip from a grating coupler. Next, a five-layer binary tree \nformed by cascaded Si3N4 MZI switches routes the incident beam to 32 channels. Thermo-optics phase shifters are \nused to control the on-chip light path. The edge emitters are etched facet inverse tapers with a tip width of 300 nm. \nThe pitch between two adjacent edge emitters is 65 \u00b5m. The schematic of the solid-state beam scanner is depicted in \nFig. 1 (b). Beam emitted from the chip is collimated by an aspherical lens (f = 8.0 mm, NA = 0.5). Then the output \nbeam is aligned to a lithographically patterned diffraction transmission grating (966.18 lines/mm) at the Littrow \nangle. Next, a 45\u00b0 aluminum-coated mirror fixed in the 3D printed mount is used to deflect the beam direction. To \ncharacterize the beam steering, we set a screen in front of the beam scanner at a distance of 2.1 m. An infrared \ncamera records the beam profile on the screen. As shown in Fig. 1 (c), the main beam is steered across a range of \n14.3\u00b0 in \u03b8-direction by toggling the optical switches. Though phase errors still exist in the Si3N4 photonic integrated \ncircuit, the initial phase calibration takes only a few minutes. This problem can be further solved by the real-time \nfeedback control with on-chip power monitors. The angular step between two adjacent points is 0.46\u00b0, which can be \nmuch decreased by enlarging the array size in our future work. A beam steering range of 9.9\u00b0 in the \uf06a-direction is \nachieved by tuning the wavelength from 1500 nm to 1610 nm, as shown in Fig. 1 (d). The steering efficiency thus is \naround 0.09\u00b0/ nm, which is higher than the on-chip Si3N4 grating antenna in [13]. The demand of wideband tunable \nlaser with narrow linewidth still hinders further cost reduction. However, it can be solved by using the massive \ncoherent laser based on the microcomb in [14]. Finally, two-dimensional beam steering is achieved by wavelength \ntuning and switching of channels, as shown in Fig 1. (e). The beam divergency in both directions is measured to be \n< 0.1\u00b0. \n \n3.  FMCW Ranging Operation \nThe setup for FMCW ranging operation is shown in Fig. 2 (a). The FMCW RF signal is provided by the frequency \nsynthesizer based on a fractional-N phased-locked loop (PLL). It generates sawtooth chirps with a period of 1 ms. \nThe chirp range is approximately from 6 GHz to 9 GHz, as shown in Fig. 2 (b). Then the chirped laser light is \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\ngenerated by using an optical single sideband modulator. A 3dB optical power splitter distributes the output of the \nmodulator into two components: one goes straight to the balance detector as the local reference light, and the \nremaining is amplified by an Erbium-doped fiber amplifier (EDFA) as the input of the Si3N4 chip. The backscattered \nlight from the target is collected by a fiber collimator and routed to the balanced detector. An oscillograph records \nthe output of the balanced photodetector and performs real-time FFT analysis. Representative beat signals in the \ntime domain and the frequency domain of a target at 7.4m away are depicted in Fig. 2 (c) and Fig. 2 (d), respectively. \nFigure 2 (e) shows the measured beat frequency when the target distance varies from 0.7 m to 7.4 m. A strong linear \ncorrelation between the beat frequency and the target distance is observed. The slope of the linear fit is around 20.54 \nkHz/m, which is in line with the chirp slope of \u223c 3 MHz/\u00b5s. It is worth noting that the intercept at the frequency \naxis comes from the fixed fiber length difference. The chirp slope can be further increased by using FMCW PLL ICs \n[15], in order to speed up the ranging operation. \n \n4.  Conclusion \nIn conclusion, we demonstrate a hybrid solid-state beam scanner based on the Si3N4 switching array. The \ncombination of the edge emitter and the external transmission grating improves the beam quality as well as the \noptical emission efficiency. Besides, no prism lens with special designs and mechanical moving components exist in \nthe easily implemented beam scanner. Two-dimensional beam steering with a FOV of 14.3\u00b0 \u00d7 9.9\u00b0 is achieved by \nswitch toggling and wavelength tuning. Furthermore, FMCW ranging operation up to 7.4 m is also presented by \nusing the Si3N4 switching array as the transmitter. Our measurements indicate that the proposed hybrid solid-state \nbeam scanner is a scalable and flexible solution for the next-generation FMCW LiDAR. \n \n5.  References \n \n[1] D. N. Hutchison, J. Sun, J. K. Doylend, R. Kumar, J. Heck, W. Kim, C. T. Phare, A. Feshali, and H. Rong, \u201cHigh-resolution aliasing-free \noptical beam steering\u201d, Optica 3, 887\u2013890 (2016). \n[2] H. Ito, Y. Kusunoki, J. Maeda, D. Akiyama, N. Kodama, H. Abe, R. Tetsuya, and T. Baba, \u201cWide beam steering by slow-light waveguide \ngratings and a prism lens\u201d, Optica 7, 47\u201352 (2020). \n[3] J. Park, B. G. Jeong, S. I. Kim, D. Lee, J. Kim, C. Shin, C. B. Lee, T. Otsuka, J. Kyoung, S. Kim, K.-Y. Yang, Y.-Y. Park, J. Lee, I. Hwang, J. \nJang, S. H. Song, M. L. Brongersma, K. Ha, S.-W. Hwang, H. Choo, and B. L. Choi, \u201cAll-solid-state spatial light modulator with independent \nphase and amplitude control for three-dimensional LiDAR applications\u201d, Nat. Nanotechnol. 16, 69\u201376 (2021). \n[4] R. Li, S. Hu, X. Gu, and F. Koyama, \u201cSolid-state slow-light beam scanner with ultra-large field of view and high resolution\u201d, J. Light. \nTechnol. 40, 1855\u20131861 (2022). \n[5] C. V. Poulton, M. J. Byrd, P. Russo, E. Timurdogan, M. Khandaker, D. Vermeulen, and M. R. Watts, \u201cLong-range LiDAR and free-space \ndata communication with high-performance optical phased arrays\u201d, IEEE J. Sel. Top. Quantum Electron. 25, 1\u20138 (2019). \n[6] Y. Li, B. Chen, Q. Na, Q. Xie, M. Tao, L. Zhang, Z. Zhi, Y. Li, X. Liu, X. Luo, G. Lo, F. Gao, X. Li, and J. Song, \u201cWide-steering-angle high-\nresolution optical phased array\u201d, Photon. Res. 9, 2511\u20132518 (2021). \n[7] W. Xu, Y. Guo, X. Li, C. Liu, L. Lu, J. Chen, and L. Zhou, \u201cFully integrated solid-state lidar transmitter on a multi-layer silicon-nitride-on-\nsilicon photonic platform\u201d, J. Light. Technol. pp. 1\u201310 (2022). \n[8] T. Komljenovic and P. Pintus, \u201cOn-chip calibration and control of optical phased arrays\u201d, Opt. Express 26, 3199\u20133210 (2018). \n[9] X. Zhang, K. Kwon, J. Henriksson, J. Luo, and M. C. Wu, \u201cA large-scale microelectromechanical-systems-based silicon photonics LiDAR\u201d, \nNature 603, 253\u2013258 (2022). \n[10] C. Rogers, A. Y. Piggott, D. J. Thomson, R. F. Wiser, I. E. Opris, S. A. Fortune, A. J. Compston, A. Gondarenko, F. Meng, X. Chen, G. T. \nReed, and R. Nicolaescu, \u201cA universal 3D imaging sensor on a silicon photonics platform\u201d, Nature 590, 256\u2013261 (2021). \n[11] F. Eltes, C. Mai, D. Caimi, M. Kroh, Y. Popoff, G. Winzer, D. Petousi, S. Lischke, J. E. Ortmann, L. Czornomaz, L. Zimmermann, J. Fom-\npeyrine, and S. Abel, \u201cA BaTiO3-based electro-optic Pockels modulator monolithically integrated on an advanced silicon photonics platform\u201d, J. \nLight. Technol. 37, 1456\u20131462 (2019). \n[12] K. Alexander, J. P. George, J. Verbist, K. Neyts, B. Kuyken, D. Van Thourhout, and J. Beeckman, \u201cNanophotonic Pockels modulators on a \nsilicon nitride platform\u201d, Nat. Commun. 9, 3444 (2018). \n[13] C. Li, X. Cao, K. Wu, G. Qiu, M. Cai, G. Zhang, X. Li, and J. Chen, \u201cBlind zone-suppressed hybrid beam steering for solid-state LiDAR\u201d, \nPhoton. Res. 9, 1871\u20131880 (2021). \n[14] J. Riemensberger, A. Lukashchuk, M. Karpov, W. Weng, E. Lucas, J. Liu, and T. J. Kippenberg, \u201cMassively parallel coherent laser ranging \nusing a soliton microcomb\u201d, Nature 581, 164\u2013170 (2020). \n[15] H. Shanan, D. Dalton, V. Chillara, and P. Dato, \u201cA 9-to-12GHz coupled-RTWO FMCW ADPLL with 97fs rms jitter, -120dBc/Hz PN at \n1MHz offset, and with retrace time of 12.5 ns and 2 \u03bcs chirp settling time\u201d, in 2022 IEEE International Solid- State Circuits Conference (ISSCC), \nvol. 65 (2022), pp. 146\u2013148. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\n\nResponse: single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Edge emitters\n  - Diffraction transmission grating\n  - Fiber collimator\n  - Balanced photodetector",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725620065.282336",
    "msecs": "282.0",
    "relativeCreated": "111973.20222854614",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- \n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback.\nQuery: single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Edge emitters\n  - Diffraction transmission grating\n  - Fiber collimator\n  - Balanced photodetector\nResponse: - The list includes \"Fiber collimator,\" which is typically an off-chip component.\n- \"Edge emitters\" might also be considered off-chip depending on the context.\n- The rest of the components accurately represent photonic components on the chip.\n- No other photonic components seem to be missing based on the provided list.\n\nOverall, the list should exclude off-chip components like the \"Fiber collimator\" and potentially \"Edge emitters\" to accurately represent only the on-chip photonic components.",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm prompt",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "209",
    "funcName": "_backward_through_llm_base",
    "created": "1725620065.2833002",
    "msecs": "283.0",
    "relativeCreated": "111974.16639328003",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "You will give feedback to a variable with the following role: <ROLE> The yaml file to optimize </ROLE>. Here is an evaluation of the variable using a language model:\n\n<LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- \n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Edge emitters\n  - Diffraction transmission grating\n  - Fiber collimator\n  - Balanced photodetector </LM_INPUT>\n\n<LM_OUTPUT> - The list includes \"Fiber collimator,\" which is typically an off-chip component.\n- \"Edge emitters\" might also be considered off-chip depending on the context.\n- The rest of the components accurately represent photonic components on the chip.\n- No other photonic components seem to be missing based on the provided list.\n\nOverall, the list should exclude off-chip components like the \"Fiber collimator\" and potentially \"Edge emitters\" to accurately represent only the on-chip photonic components. </LM_OUTPUT>\n\n<OBJECTIVE_FUNCTION>Your goal is to give feedback and criticism to the variable given the above evaluation output. Our only goal is to improve the above metric, and nothing else. </OBJECTIVE_FUNCTION>\n\nWe are interested in giving feedback to the The yaml file to optimize for this conversation. Specifically, give feedback to the following span of text:\n\n<VARIABLE> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - (...) transmission grating\n  - Fiber collimator\n  - Balanced photodetector </VARIABLE>\n\nGiven the above history, describe how the The yaml file to optimize could be improved to improve the <OBJECTIVE_FUNCTION>. Be very creative, critical, and intelligent.\n\n",
    "message": "_backward_through_llm prompt"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm gradient",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "211",
    "funcName": "_backward_through_llm_base",
    "created": "1725620065.2833002",
    "msecs": "283.0",
    "relativeCreated": "111974.16639328003",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The evaluation highlights that \"Fiber collimator\" is typically an off-chip component. Removing this entry will ensure the list accurately represents only on-chip photonic components.\n\n2. **Clarify Context for Edge Emitters**: The evaluation mentions that \"Edge emitters\" might be considered off-chip depending on the context. To avoid ambiguity, either remove this component or provide a clear context within the YAML file that specifies it is an on-chip component if applicable.\n\n3. **Ensure Exclusivity to Photonic Components**: Double-check that all listed components are strictly photonic and relevant to the chip. This will prevent any non-photonic or irrelevant components from being included.\n\n4. **Verify Completeness**: Although the evaluation states no other photonic components seem to be missing, it is prudent to cross-reference with the source article to ensure all relevant on-chip photonic components are included.\n\n5. **Consistent Terminology**: Ensure that the terminology used for each component is consistent with the source article to avoid any misinterpretation or confusion.\n\nBy addressing these points, the YAML file will better align with the objective of accurately summarizing the photonic components presented in the input article, focusing exclusively on on-chip components.",
    "message": "_backward_through_llm gradient"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent prompt for update",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "165",
    "funcName": "_update_prompt",
    "created": "1725620065.2842977",
    "msecs": "284.0",
    "relativeCreated": "111975.16393661499",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "prompt": "Here is the role of the variable you will improve: <ROLE>The yaml file to optimize</ROLE>.\n\nThe variable is the text within the following span: <VARIABLE> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - (...) transmission grating\n  - Fiber collimator\n  - Balanced photodetector </VARIABLE>\n\nHere is the context and feedback we got for the variable:\n\n<CONTEXT>Here is a conversation:\n\n<CONVERSATION><LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- \n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Edge emitters\n  - Diffraction transmission grating\n  - Fiber collimator\n  - Balanced photodetector </LM_INPUT>\n\n<LM_OUTPUT> - The list includes \"Fiber collimator,\" which is typically an off-chip component.\n- \"Edge emitters\" might also be considered off-chip depending on the context.\n- The rest of the components accurately represent photonic components on the chip.\n- No other photonic components seem to be missing based on the provided list.\n\nOverall, the list should exclude off-chip components like the \"Fiber collimator\" and potentially \"Edge emitters\" to accurately represent only the on-chip photonic components. </LM_OUTPUT>\n\n</CONVERSATION>\n\nThis conversation is potentially part of a larger system. The output is used as response from the language model\n\nHere is the feedback we got for The yaml file to optimize in the conversation:\n\n<FEEDBACK>To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The evaluation highlights that \"Fiber collimator\" is typically an off-chip component. Removing this entry will ensure the list accurately represents only on-chip photonic components.\n\n2. **Clarify Context for Edge Emitters**: The evaluation mentions that \"Edge emitters\" might be considered off-chip depending on the context. To avoid ambiguity, either remove this component or provide a clear context within the YAML file that specifies it is an on-chip component if applicable.\n\n3. **Ensure Exclusivity to Photonic Components**: Double-check that all listed components are strictly photonic and relevant to the chip. This will prevent any non-photonic or irrelevant components from being included.\n\n4. **Verify Completeness**: Although the evaluation states no other photonic components seem to be missing, it is prudent to cross-reference with the source article to ensure all relevant on-chip photonic components are included.\n\n5. **Consistent Terminology**: Ensure that the terminology used for each component is consistent with the source article to avoid any misinterpretation or confusion.\n\nBy addressing these points, the YAML file will better align with the objective of accurately summarizing the photonic components presented in the input article, focusing exclusively on on-chip components.</FEEDBACK>\n\n</CONTEXT>\n\nImprove the variable (The yaml file to optimize) using the feedback provided in <FEEDBACK> tags.\nSend the improved variable in the following format:\n\n<IMPROVED_VARIABLE>{the improved variable}</IMPROVED_VARIABLE>\n\nSend ONLY the improved variable between the <IMPROVED_VARIABLE> tags, and nothing else.",
    "message": "TextualGradientDescent prompt for update"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent optimizer response",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "179",
    "funcName": "step",
    "created": "1725620065.285295",
    "msecs": "285.0",
    "relativeCreated": "111976.16124153137",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "optimizer.response": "<IMPROVED_VARIABLE>\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Diffraction transmission grating\n  - Balanced photodetector\n</IMPROVED_VARIABLE>",
    "message": "TextualGradientDescent optimizer response"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent updated text",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "187",
    "funcName": "step",
    "created": "1725620065.285295",
    "msecs": "285.0",
    "relativeCreated": "111976.16124153137",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "parameter.value": "single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array\n  - Mach\u2013Zehnder interferometer (MZI) switches\n  - Thermo-optics phase shifters\n  - Grating coupler\n  - Diffraction transmission grating\n  - Balanced photodetector",
    "message": "TextualGradientDescent updated text"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725620843.4722111",
    "msecs": "472.0",
    "relativeCreated": "890163.0773544312",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:None\nQuery: Is this a single academic article, and not a dissertation or collection of papers (single_article)?\nIs the main topic of this article about integrated photonic circuits (topic_photonic)?\nIf yes, find the photonic components that are used on the chip. \nReturn a concise list of these photonic components, if any (components_list).\nFor each component, try to extract: brief spec, \nand the number of optical input and output ports denoted by (input)x(output).\nAnswer in YAML following the template:\nsingle_article: True/False\ntopic_photonic: True/False\ncomponents_list:\n  - a 1x1 modulator with MHz speed\n  - a 1x2 component ...\n  ...\n\nOnly output a YAML text without any preamble like quotations. \n  \nINPUT ARTICLE:\nA Hybrid Solid-State Beam Scanner for FMCW \nLiDAR Application \nZhaoyang Zhang,1 Xufeng Du,2 Zhiyan Zhou,1 Qikai Huang,1 Qiang Zhang,3 \nTingge Dai,1 Hui Yu,1 Yuehai Wang,1 and Jianyi Yang 1, * \n1 College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou 310027, China \n2 Guofeng Electronics, Manzhouli 021400, China \n3 Zhejiang Lab, Hangzhou 311121, China \nAuthor e-mail address: yangjy@zju.edu.cn \nAbstract: We demonstrate a hybrid solid-state beam scanner based on a Si3N4 switching array. \nTwo-dimensional beam steering with a 14.3\u00b0\u00d79.9\u00b0\n field of view and FMCW ranging operation at a \ndistance of 7.4 m are achieved.   \n1. Introduction\nDue to the huge demand brought by the promotion of autonomous driving and robotics, light detection and ranging \n(LiDAR) technology has attracted extensive attention in the past decade. To date, various types of on-chip beam \nscanners have been demonstrated to replace mechanical scanners [1\u20134]. Optical phased arrays on silicon-on-\ninsulator (SOI) provide an attractive method to perform non-mechanical beam steering [5\u20137]. However, it still \nsuffers from the extensive and complex active phase shifting, in order to calibrate the stochastic phase errors in the \narrayed waveguides [8]. Focal plane switching arrays based on silicon photonics platform and MEMS platform \nemerge as an alternative approach due to the advantages of compact size, low power consumption and simple \ncontrol [9,10]. Among them, beam scanners based on Mach\u2013Zehnder interferometer (MZI) abandon the \nmechanical moving parts entirely. In addition, ultra high-speed and low-loss optical switches can be obtained by \nintegrating novel materials with high Pockels coefficients [11,12]. In this work, we demonstrate a hybrid solid-\nstate beam scanner based on a Si3N4 switching array and a blazed grating. The output beam is steered across the \n14.3\u00b0 \u00d7 9.9\u00b0 field of view (FOV) with beam divergence less than 0.1\u00b0. In addition, a ranging distance of 7.4 m is \nachieved by combining the proposed beam scanner and the frequency-modulated continuous-wave (FMCW) \ntechnology. \nFig. 1.  (a) Microscope photograph of the fabricated Si3N4 switching array chip. (b) Schematic of the hybrid \nsolid-state beam scanner. (c) Intensity cuts in \u03b8-direction of 32 separate beams at different angles. (d) \nMeasured beam scanning result and the theoretical value of the transmission grating in \uf06a-direction versus the \nworking wavelength. (e) Two-dimensional beam scanning observed on the screen. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\u00a9 2023 The Author(s)\n \nFig. 2. (a) Experimental setup of the FMCW ranging operation using the beam scanner. (b) The spectrum of \nthe PLL based FMCW synthesizer. (c) and (d) are the time domain and frequency domain signals \ncorresponding to the target of 7.4 m, respectively. (e) Measured beat frequency versus the ranging distance. \n \n2.  Device Fabrication and Beam Steering \nAn optical micrograph of the 32-channel Si3N4 switching array with an overall footprint of 2.2 mm \u00d7 10 mm is \nshown in Fig. 1 (a). The device is fabricated on an 8-inch wafer with a 400 nm-thick PECVD Si3N4 layer by \nAdvanced Micro Foundry. Light is coupled into the chip from a grating coupler. Next, a five-layer binary tree \nformed by cascaded Si3N4 MZI switches routes the incident beam to 32 channels. Thermo-optics phase shifters are \nused to control the on-chip light path. The edge emitters are etched facet inverse tapers with a tip width of 300 nm. \nThe pitch between two adjacent edge emitters is 65 \u00b5m. The schematic of the solid-state beam scanner is depicted in \nFig. 1 (b). Beam emitted from the chip is collimated by an aspherical lens (f = 8.0 mm, NA = 0.5). Then the output \nbeam is aligned to a lithographically patterned diffraction transmission grating (966.18 lines/mm) at the Littrow \nangle. Next, a 45\u00b0 aluminum-coated mirror fixed in the 3D printed mount is used to deflect the beam direction. To \ncharacterize the beam steering, we set a screen in front of the beam scanner at a distance of 2.1 m. An infrared \ncamera records the beam profile on the screen. As shown in Fig. 1 (c), the main beam is steered across a range of \n14.3\u00b0 in \u03b8-direction by toggling the optical switches. Though phase errors still exist in the Si3N4 photonic integrated \ncircuit, the initial phase calibration takes only a few minutes. This problem can be further solved by the real-time \nfeedback control with on-chip power monitors. The angular step between two adjacent points is 0.46\u00b0, which can be \nmuch decreased by enlarging the array size in our future work. A beam steering range of 9.9\u00b0 in the \uf06a-direction is \nachieved by tuning the wavelength from 1500 nm to 1610 nm, as shown in Fig. 1 (d). The steering efficiency thus is \naround 0.09\u00b0/ nm, which is higher than the on-chip Si3N4 grating antenna in [13]. The demand of wideband tunable \nlaser with narrow linewidth still hinders further cost reduction. However, it can be solved by using the massive \ncoherent laser based on the microcomb in [14]. Finally, two-dimensional beam steering is achieved by wavelength \ntuning and switching of channels, as shown in Fig 1. (e). The beam divergency in both directions is measured to be \n< 0.1\u00b0. \n \n3.  FMCW Ranging Operation \nThe setup for FMCW ranging operation is shown in Fig. 2 (a). The FMCW RF signal is provided by the frequency \nsynthesizer based on a fractional-N phased-locked loop (PLL). It generates sawtooth chirps with a period of 1 ms. \nThe chirp range is approximately from 6 GHz to 9 GHz, as shown in Fig. 2 (b). Then the chirped laser light is \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\ngenerated by using an optical single sideband modulator. A 3dB optical power splitter distributes the output of the \nmodulator into two components: one goes straight to the balance detector as the local reference light, and the \nremaining is amplified by an Erbium-doped fiber amplifier (EDFA) as the input of the Si3N4 chip. The backscattered \nlight from the target is collected by a fiber collimator and routed to the balanced detector. An oscillograph records \nthe output of the balanced photodetector and performs real-time FFT analysis. Representative beat signals in the \ntime domain and the frequency domain of a target at 7.4m away are depicted in Fig. 2 (c) and Fig. 2 (d), respectively. \nFigure 2 (e) shows the measured beat frequency when the target distance varies from 0.7 m to 7.4 m. A strong linear \ncorrelation between the beat frequency and the target distance is observed. The slope of the linear fit is around 20.54 \nkHz/m, which is in line with the chirp slope of \u223c 3 MHz/\u00b5s. It is worth noting that the intercept at the frequency \naxis comes from the fixed fiber length difference. The chirp slope can be further increased by using FMCW PLL ICs \n[15], in order to speed up the ranging operation. \n \n4.  Conclusion \nIn conclusion, we demonstrate a hybrid solid-state beam scanner based on the Si3N4 switching array. The \ncombination of the edge emitter and the external transmission grating improves the beam quality as well as the \noptical emission efficiency. Besides, no prism lens with special designs and mechanical moving components exist in \nthe easily implemented beam scanner. Two-dimensional beam steering with a FOV of 14.3\u00b0 \u00d7 9.9\u00b0 is achieved by \nswitch toggling and wavelength tuning. Furthermore, FMCW ranging operation up to 7.4 m is also presented by \nusing the Si3N4 switching array as the transmitter. Our measurements indicate that the proposed hybrid solid-state \nbeam scanner is a scalable and flexible solution for the next-generation FMCW LiDAR. \n \n5.  References \n \n[1] D. N. Hutchison, J. Sun, J. K. Doylend, R. Kumar, J. Heck, W. Kim, C. T. Phare, A. Feshali, and H. Rong, \u201cHigh-resolution aliasing-free \noptical beam steering\u201d, Optica 3, 887\u2013890 (2016). \n[2] H. Ito, Y. Kusunoki, J. Maeda, D. Akiyama, N. Kodama, H. Abe, R. Tetsuya, and T. Baba, \u201cWide beam steering by slow-light waveguide \ngratings and a prism lens\u201d, Optica 7, 47\u201352 (2020). \n[3] J. Park, B. G. Jeong, S. I. Kim, D. Lee, J. Kim, C. Shin, C. B. Lee, T. Otsuka, J. Kyoung, S. Kim, K.-Y. Yang, Y.-Y. Park, J. Lee, I. Hwang, J. \nJang, S. H. Song, M. L. Brongersma, K. Ha, S.-W. Hwang, H. Choo, and B. L. Choi, \u201cAll-solid-state spatial light modulator with independent \nphase and amplitude control for three-dimensional LiDAR applications\u201d, Nat. Nanotechnol. 16, 69\u201376 (2021). \n[4] R. Li, S. Hu, X. Gu, and F. Koyama, \u201cSolid-state slow-light beam scanner with ultra-large field of view and high resolution\u201d, J. Light. \nTechnol. 40, 1855\u20131861 (2022). \n[5] C. V. Poulton, M. J. Byrd, P. Russo, E. Timurdogan, M. Khandaker, D. Vermeulen, and M. R. Watts, \u201cLong-range LiDAR and free-space \ndata communication with high-performance optical phased arrays\u201d, IEEE J. Sel. Top. Quantum Electron. 25, 1\u20138 (2019). \n[6] Y. Li, B. Chen, Q. Na, Q. Xie, M. Tao, L. Zhang, Z. Zhi, Y. Li, X. Liu, X. Luo, G. Lo, F. Gao, X. Li, and J. Song, \u201cWide-steering-angle high-\nresolution optical phased array\u201d, Photon. Res. 9, 2511\u20132518 (2021). \n[7] W. Xu, Y. Guo, X. Li, C. Liu, L. Lu, J. Chen, and L. Zhou, \u201cFully integrated solid-state lidar transmitter on a multi-layer silicon-nitride-on-\nsilicon photonic platform\u201d, J. Light. Technol. pp. 1\u201310 (2022). \n[8] T. Komljenovic and P. Pintus, \u201cOn-chip calibration and control of optical phased arrays\u201d, Opt. Express 26, 3199\u20133210 (2018). \n[9] X. Zhang, K. Kwon, J. Henriksson, J. Luo, and M. C. Wu, \u201cA large-scale microelectromechanical-systems-based silicon photonics LiDAR\u201d, \nNature 603, 253\u2013258 (2022). \n[10] C. Rogers, A. Y. Piggott, D. J. Thomson, R. F. Wiser, I. E. Opris, S. A. Fortune, A. J. Compston, A. Gondarenko, F. Meng, X. Chen, G. T. \nReed, and R. Nicolaescu, \u201cA universal 3D imaging sensor on a silicon photonics platform\u201d, Nature 590, 256\u2013261 (2021). \n[11] F. Eltes, C. Mai, D. Caimi, M. Kroh, Y. Popoff, G. Winzer, D. Petousi, S. Lischke, J. E. Ortmann, L. Czornomaz, L. Zimmermann, J. Fom-\npeyrine, and S. Abel, \u201cA BaTiO3-based electro-optic Pockels modulator monolithically integrated on an advanced silicon photonics platform\u201d, J. \nLight. Technol. 37, 1456\u20131462 (2019). \n[12] K. Alexander, J. P. George, J. Verbist, K. Neyts, B. Kuyken, D. Van Thourhout, and J. Beeckman, \u201cNanophotonic Pockels modulators on a \nsilicon nitride platform\u201d, Nat. Commun. 9, 3444 (2018). \n[13] C. Li, X. Cao, K. Wu, G. Qiu, M. Cai, G. Zhang, X. Li, and J. Chen, \u201cBlind zone-suppressed hybrid beam steering for solid-state LiDAR\u201d, \nPhoton. Res. 9, 1871\u20131880 (2021). \n[14] J. Riemensberger, A. Lukashchuk, M. Karpov, W. Weng, E. Lucas, J. Liu, and T. J. Kippenberg, \u201cMassively parallel coherent laser ranging \nusing a soliton microcomb\u201d, Nature 581, 164\u2013170 (2020). \n[15] H. Shanan, D. Dalton, V. Chillara, and P. Dato, \u201cA 9-to-12GHz coupled-RTWO FMCW ADPLL with 97fs rms jitter, -120dBc/Hz PN at \n1MHz offset, and with retrace time of 12.5 ns and 2 \u03bcs chirp settling time\u201d, in 2022 IEEE International Solid- State Circuits Conference (ISSCC), \nvol. 65 (2022), pp. 146\u2013148. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\n\nResponse: ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 ports\n  - Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports\n  - Grating coupler with 1x1 ports\n  - Edge emitters with 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n```",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725620844.9823294",
    "msecs": "982.0",
    "relativeCreated": "891673.1956005096",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback.\nQuery: ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 ports\n  - Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports\n  - Grating coupler with 1x1 ports\n  - Edge emitters with 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n```\nResponse: - The list accurately represents photonic components on the chip.\n- The components listed are relevant and correctly identified as photonic components.\n- No photonic component appears to be missing based on the provided list.\n- The list is concise and focused on photonic components only.",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm prompt",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "209",
    "funcName": "_backward_through_llm_base",
    "created": "1725620844.9823294",
    "msecs": "982.0",
    "relativeCreated": "891673.1956005096",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "You will give feedback to a variable with the following role: <ROLE> The yaml file to optimize </ROLE>. Here is an evaluation of the variable using a language model:\n\n<LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 ports\n  - Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports\n  - Grating coupler with 1x1 ports\n  - Edge emitters with 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n``` </LM_INPUT>\n\n<LM_OUTPUT> - The list accurately represents photonic components on the chip.\n- The components listed are relevant and correctly identified as photonic components.\n- No photonic component appears to be missing based on the provided list.\n- The list is concise and focused on photonic components only. </LM_OUTPUT>\n\n<OBJECTIVE_FUNCTION>Your goal is to give feedback and criticism to the variable given the above evaluation output. Our only goal is to improve the above metric, and nothing else. </OBJECTIVE_FUNCTION>\n\nWe are interested in giving feedback to the The yaml file to optimize for this conversation. Specifically, give feedback to the following span of text:\n\n<VARIABLE> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with (...) 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n``` </VARIABLE>\n\nGiven the above history, describe how the The yaml file to optimize could be improved to improve the <OBJECTIVE_FUNCTION>. Be very creative, critical, and intelligent.\n\n",
    "message": "_backward_through_llm prompt"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm gradient",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "211",
    "funcName": "_backward_through_llm_base",
    "created": "1725620850.1715577",
    "msecs": "171.0",
    "relativeCreated": "896862.4238967896",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "1. **Redundancy and Relevance**:\n   - The `single_article: True` and `topic_photonic: True` fields are not directly related to the list of photonic components. Since the objective is to have a list of photonic components, these fields could be considered extraneous and might be removed to keep the YAML file focused solely on the components.\n\n2. **Component Details**:\n   - While the components are accurately listed, the descriptions could be more standardized. For example, specifying the material (e.g., Si3N4) for each component could provide more clarity and uniformity. This would help in maintaining consistency and making the list more informative.\n\n3. **Port Information**:\n   - The port information (e.g., 32x32 ports, 2x2 ports) is useful, but it might be more beneficial to separate this information into a different attribute for each component. This would make the YAML file more structured and easier to parse programmatically.\n\n4. **Component Completeness**:\n   - Although the evaluation states that no photonic component appears to be missing, it might be useful to cross-reference with a comprehensive list of standard photonic components to ensure completeness. This could involve checking for other common components like ring resonators, waveguides, or modulators that might be relevant to the context.\n\n5. **Component Categorization**:\n   - Categorizing the components into subgroups (e.g., switches, couplers, emitters) could improve readability and organization. This would help in quickly identifying the type of each component and understanding its role in the photonic circuit.\n\n6. **Documentation and Comments**:\n   - Adding comments or documentation within the YAML file to explain the purpose of each component or any specific details about their usage could enhance the file's utility. This would be particularly useful for someone new to the topic or for future reference.\n\n7. **Validation and Consistency**:\n   - Implementing a validation schema to ensure that all components follow a consistent format and that required fields are present could improve the reliability of the YAML file. This could involve using tools like JSON Schema for YAML validation.\n\nBy addressing these points, the YAML file can be made more precise, informative, and easier to use, thereby improving the overall objective of accurately summarizing photonic components.",
    "message": "_backward_through_llm gradient"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent prompt for update",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "165",
    "funcName": "_update_prompt",
    "created": "1725620850.1725554",
    "msecs": "172.0",
    "relativeCreated": "896863.4216785431",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "prompt": "Here is the role of the variable you will improve: <ROLE>The yaml file to optimize</ROLE>.\n\nThe variable is the text within the following span: <VARIABLE> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with (...) 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n``` </VARIABLE>\n\nHere is the context and feedback we got for the variable:\n\n<CONTEXT>Here is a conversation:\n\n<CONVERSATION><LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 ports\n  - Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports\n  - Grating coupler with 1x1 ports\n  - Edge emitters with 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n``` </LM_INPUT>\n\n<LM_OUTPUT> - The list accurately represents photonic components on the chip.\n- The components listed are relevant and correctly identified as photonic components.\n- No photonic component appears to be missing based on the provided list.\n- The list is concise and focused on photonic components only. </LM_OUTPUT>\n\n</CONVERSATION>\n\nThis conversation is potentially part of a larger system. The output is used as response from the language model\n\nHere is the feedback we got for The yaml file to optimize in the conversation:\n\n<FEEDBACK>1. **Redundancy and Relevance**:\n   - The `single_article: True` and `topic_photonic: True` fields are not directly related to the list of photonic components. Since the objective is to have a list of photonic components, these fields could be considered extraneous and might be removed to keep the YAML file focused solely on the components.\n\n2. **Component Details**:\n   - While the components are accurately listed, the descriptions could be more standardized. For example, specifying the material (e.g., Si3N4) for each component could provide more clarity and uniformity. This would help in maintaining consistency and making the list more informative.\n\n3. **Port Information**:\n   - The port information (e.g., 32x32 ports, 2x2 ports) is useful, but it might be more beneficial to separate this information into a different attribute for each component. This would make the YAML file more structured and easier to parse programmatically.\n\n4. **Component Completeness**:\n   - Although the evaluation states that no photonic component appears to be missing, it might be useful to cross-reference with a comprehensive list of standard photonic components to ensure completeness. This could involve checking for other common components like ring resonators, waveguides, or modulators that might be relevant to the context.\n\n5. **Component Categorization**:\n   - Categorizing the components into subgroups (e.g., switches, couplers, emitters) could improve readability and organization. This would help in quickly identifying the type of each component and understanding its role in the photonic circuit.\n\n6. **Documentation and Comments**:\n   - Adding comments or documentation within the YAML file to explain the purpose of each component or any specific details about their usage could enhance the file's utility. This would be particularly useful for someone new to the topic or for future reference.\n\n7. **Validation and Consistency**:\n   - Implementing a validation schema to ensure that all components follow a consistent format and that required fields are present could improve the reliability of the YAML file. This could involve using tools like JSON Schema for YAML validation.\n\nBy addressing these points, the YAML file can be made more precise, informative, and easier to use, thereby improving the overall objective of accurately summarizing photonic components.</FEEDBACK>\n\n</CONTEXT>\n\nImprove the variable (The yaml file to optimize) using the feedback provided in <FEEDBACK> tags.\nSend the improved variable in the following format:\n\n<IMPROVED_VARIABLE>{the improved variable}</IMPROVED_VARIABLE>\n\nSend ONLY the improved variable between the <IMPROVED_VARIABLE> tags, and nothing else.",
    "message": "TextualGradientDescent prompt for update"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent optimizer response",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "179",
    "funcName": "step",
    "created": "1725620853.8460767",
    "msecs": "846.0",
    "relativeCreated": "900536.9429588318",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "optimizer.response": "<IMPROVED_VARIABLE>\ncomponents_list:\n  - name: 32-channel Si3N4 switching array\n    material: Si3N4\n    ports: 32x32\n  - name: Mach\u2013Zehnder interferometer (MZI) switches\n    material: Si3N4\n    ports: 2x2\n  - name: Thermo-optics phase shifters\n    material: Si3N4\n    ports: 1x1\n  - name: Grating coupler\n    material: Si3N4\n    ports: 1x1\n  - name: Edge emitters\n    material: Si3N4\n    ports: 1x1\n  - name: Diffraction transmission grating\n    material: Si3N4\n    ports: 1x1\n</IMPROVED_VARIABLE>",
    "message": "TextualGradientDescent optimizer response"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent updated text",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "187",
    "funcName": "step",
    "created": "1725620853.8460767",
    "msecs": "846.0",
    "relativeCreated": "900536.9429588318",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "parameter.value": "components_list:\n  - name: 32-channel Si3N4 switching array\n    material: Si3N4\n    ports: 32x32\n  - name: Mach\u2013Zehnder interferometer (MZI) switches\n    material: Si3N4\n    ports: 2x2\n  - name: Thermo-optics phase shifters\n    material: Si3N4\n    ports: 1x1\n  - name: Grating coupler\n    material: Si3N4\n    ports: 1x1\n  - name: Edge emitters\n    material: Si3N4\n    ports: 1x1\n  - name: Diffraction transmission grating\n    material: Si3N4\n    ports: 1x1",
    "message": "TextualGradientDescent updated text"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725620913.177853",
    "msecs": "177.0",
    "relativeCreated": "959868.7193393707",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:None\nQuery: Is this a single academic article, and not a dissertation or collection of papers (single_article)?\nIs the main topic of this article about integrated photonic circuits (topic_photonic)?\nIf yes, find the photonic components that are used on the chip. \nReturn a concise list of these photonic components, if any (components_list).\nFor each component, try to extract: brief spec, \nand the number of optical input and output ports denoted by (input)x(output).\nAnswer in YAML following the template:\nsingle_article: True/False\ntopic_photonic: True/False\ncomponents_list:\n  - a 1x1 modulator with MHz speed\n  - a 1x2 component ...\n  ...\n\nOnly output a YAML text without any preamble like quotations. \n  \nINPUT ARTICLE:\nA Hybrid Solid-State Beam Scanner for FMCW \nLiDAR Application \nZhaoyang Zhang,1 Xufeng Du,2 Zhiyan Zhou,1 Qikai Huang,1 Qiang Zhang,3 \nTingge Dai,1 Hui Yu,1 Yuehai Wang,1 and Jianyi Yang 1, * \n1 College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou 310027, China \n2 Guofeng Electronics, Manzhouli 021400, China \n3 Zhejiang Lab, Hangzhou 311121, China \nAuthor e-mail address: yangjy@zju.edu.cn \nAbstract: We demonstrate a hybrid solid-state beam scanner based on a Si3N4 switching array. \nTwo-dimensional beam steering with a 14.3\u00b0\u00d79.9\u00b0\n field of view and FMCW ranging operation at a \ndistance of 7.4 m are achieved.   \n1. Introduction\nDue to the huge demand brought by the promotion of autonomous driving and robotics, light detection and ranging \n(LiDAR) technology has attracted extensive attention in the past decade. To date, various types of on-chip beam \nscanners have been demonstrated to replace mechanical scanners [1\u20134]. Optical phased arrays on silicon-on-\ninsulator (SOI) provide an attractive method to perform non-mechanical beam steering [5\u20137]. However, it still \nsuffers from the extensive and complex active phase shifting, in order to calibrate the stochastic phase errors in the \narrayed waveguides [8]. Focal plane switching arrays based on silicon photonics platform and MEMS platform \nemerge as an alternative approach due to the advantages of compact size, low power consumption and simple \ncontrol [9,10]. Among them, beam scanners based on Mach\u2013Zehnder interferometer (MZI) abandon the \nmechanical moving parts entirely. In addition, ultra high-speed and low-loss optical switches can be obtained by \nintegrating novel materials with high Pockels coefficients [11,12]. In this work, we demonstrate a hybrid solid-\nstate beam scanner based on a Si3N4 switching array and a blazed grating. The output beam is steered across the \n14.3\u00b0 \u00d7 9.9\u00b0 field of view (FOV) with beam divergence less than 0.1\u00b0. In addition, a ranging distance of 7.4 m is \nachieved by combining the proposed beam scanner and the frequency-modulated continuous-wave (FMCW) \ntechnology. \nFig. 1.  (a) Microscope photograph of the fabricated Si3N4 switching array chip. (b) Schematic of the hybrid \nsolid-state beam scanner. (c) Intensity cuts in \u03b8-direction of 32 separate beams at different angles. (d) \nMeasured beam scanning result and the theoretical value of the transmission grating in \uf06a-direction versus the \nworking wavelength. (e) Two-dimensional beam scanning observed on the screen. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\u00a9 2023 The Author(s)\n \nFig. 2. (a) Experimental setup of the FMCW ranging operation using the beam scanner. (b) The spectrum of \nthe PLL based FMCW synthesizer. (c) and (d) are the time domain and frequency domain signals \ncorresponding to the target of 7.4 m, respectively. (e) Measured beat frequency versus the ranging distance. \n \n2.  Device Fabrication and Beam Steering \nAn optical micrograph of the 32-channel Si3N4 switching array with an overall footprint of 2.2 mm \u00d7 10 mm is \nshown in Fig. 1 (a). The device is fabricated on an 8-inch wafer with a 400 nm-thick PECVD Si3N4 layer by \nAdvanced Micro Foundry. Light is coupled into the chip from a grating coupler. Next, a five-layer binary tree \nformed by cascaded Si3N4 MZI switches routes the incident beam to 32 channels. Thermo-optics phase shifters are \nused to control the on-chip light path. The edge emitters are etched facet inverse tapers with a tip width of 300 nm. \nThe pitch between two adjacent edge emitters is 65 \u00b5m. The schematic of the solid-state beam scanner is depicted in \nFig. 1 (b). Beam emitted from the chip is collimated by an aspherical lens (f = 8.0 mm, NA = 0.5). Then the output \nbeam is aligned to a lithographically patterned diffraction transmission grating (966.18 lines/mm) at the Littrow \nangle. Next, a 45\u00b0 aluminum-coated mirror fixed in the 3D printed mount is used to deflect the beam direction. To \ncharacterize the beam steering, we set a screen in front of the beam scanner at a distance of 2.1 m. An infrared \ncamera records the beam profile on the screen. As shown in Fig. 1 (c), the main beam is steered across a range of \n14.3\u00b0 in \u03b8-direction by toggling the optical switches. Though phase errors still exist in the Si3N4 photonic integrated \ncircuit, the initial phase calibration takes only a few minutes. This problem can be further solved by the real-time \nfeedback control with on-chip power monitors. The angular step between two adjacent points is 0.46\u00b0, which can be \nmuch decreased by enlarging the array size in our future work. A beam steering range of 9.9\u00b0 in the \uf06a-direction is \nachieved by tuning the wavelength from 1500 nm to 1610 nm, as shown in Fig. 1 (d). The steering efficiency thus is \naround 0.09\u00b0/ nm, which is higher than the on-chip Si3N4 grating antenna in [13]. The demand of wideband tunable \nlaser with narrow linewidth still hinders further cost reduction. However, it can be solved by using the massive \ncoherent laser based on the microcomb in [14]. Finally, two-dimensional beam steering is achieved by wavelength \ntuning and switching of channels, as shown in Fig 1. (e). The beam divergency in both directions is measured to be \n< 0.1\u00b0. \n \n3.  FMCW Ranging Operation \nThe setup for FMCW ranging operation is shown in Fig. 2 (a). The FMCW RF signal is provided by the frequency \nsynthesizer based on a fractional-N phased-locked loop (PLL). It generates sawtooth chirps with a period of 1 ms. \nThe chirp range is approximately from 6 GHz to 9 GHz, as shown in Fig. 2 (b). Then the chirped laser light is \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\ngenerated by using an optical single sideband modulator. A 3dB optical power splitter distributes the output of the \nmodulator into two components: one goes straight to the balance detector as the local reference light, and the \nremaining is amplified by an Erbium-doped fiber amplifier (EDFA) as the input of the Si3N4 chip. The backscattered \nlight from the target is collected by a fiber collimator and routed to the balanced detector. An oscillograph records \nthe output of the balanced photodetector and performs real-time FFT analysis. Representative beat signals in the \ntime domain and the frequency domain of a target at 7.4m away are depicted in Fig. 2 (c) and Fig. 2 (d), respectively. \nFigure 2 (e) shows the measured beat frequency when the target distance varies from 0.7 m to 7.4 m. A strong linear \ncorrelation between the beat frequency and the target distance is observed. The slope of the linear fit is around 20.54 \nkHz/m, which is in line with the chirp slope of \u223c 3 MHz/\u00b5s. It is worth noting that the intercept at the frequency \naxis comes from the fixed fiber length difference. The chirp slope can be further increased by using FMCW PLL ICs \n[15], in order to speed up the ranging operation. \n \n4.  Conclusion \nIn conclusion, we demonstrate a hybrid solid-state beam scanner based on the Si3N4 switching array. The \ncombination of the edge emitter and the external transmission grating improves the beam quality as well as the \noptical emission efficiency. Besides, no prism lens with special designs and mechanical moving components exist in \nthe easily implemented beam scanner. Two-dimensional beam steering with a FOV of 14.3\u00b0 \u00d7 9.9\u00b0 is achieved by \nswitch toggling and wavelength tuning. Furthermore, FMCW ranging operation up to 7.4 m is also presented by \nusing the Si3N4 switching array as the transmitter. Our measurements indicate that the proposed hybrid solid-state \nbeam scanner is a scalable and flexible solution for the next-generation FMCW LiDAR. \n \n5.  References \n \n[1] D. N. Hutchison, J. Sun, J. K. Doylend, R. Kumar, J. Heck, W. Kim, C. T. Phare, A. Feshali, and H. Rong, \u201cHigh-resolution aliasing-free \noptical beam steering\u201d, Optica 3, 887\u2013890 (2016). \n[2] H. Ito, Y. Kusunoki, J. Maeda, D. Akiyama, N. Kodama, H. Abe, R. Tetsuya, and T. Baba, \u201cWide beam steering by slow-light waveguide \ngratings and a prism lens\u201d, Optica 7, 47\u201352 (2020). \n[3] J. Park, B. G. Jeong, S. I. Kim, D. Lee, J. Kim, C. Shin, C. B. Lee, T. Otsuka, J. Kyoung, S. Kim, K.-Y. Yang, Y.-Y. Park, J. Lee, I. Hwang, J. \nJang, S. H. Song, M. L. Brongersma, K. Ha, S.-W. Hwang, H. Choo, and B. L. Choi, \u201cAll-solid-state spatial light modulator with independent \nphase and amplitude control for three-dimensional LiDAR applications\u201d, Nat. Nanotechnol. 16, 69\u201376 (2021). \n[4] R. Li, S. Hu, X. Gu, and F. Koyama, \u201cSolid-state slow-light beam scanner with ultra-large field of view and high resolution\u201d, J. Light. \nTechnol. 40, 1855\u20131861 (2022). \n[5] C. V. Poulton, M. J. Byrd, P. Russo, E. Timurdogan, M. Khandaker, D. Vermeulen, and M. R. Watts, \u201cLong-range LiDAR and free-space \ndata communication with high-performance optical phased arrays\u201d, IEEE J. Sel. Top. Quantum Electron. 25, 1\u20138 (2019). \n[6] Y. Li, B. Chen, Q. Na, Q. Xie, M. Tao, L. Zhang, Z. Zhi, Y. Li, X. Liu, X. Luo, G. Lo, F. Gao, X. Li, and J. Song, \u201cWide-steering-angle high-\nresolution optical phased array\u201d, Photon. Res. 9, 2511\u20132518 (2021). \n[7] W. Xu, Y. Guo, X. Li, C. Liu, L. Lu, J. Chen, and L. Zhou, \u201cFully integrated solid-state lidar transmitter on a multi-layer silicon-nitride-on-\nsilicon photonic platform\u201d, J. Light. Technol. pp. 1\u201310 (2022). \n[8] T. Komljenovic and P. Pintus, \u201cOn-chip calibration and control of optical phased arrays\u201d, Opt. Express 26, 3199\u20133210 (2018). \n[9] X. Zhang, K. Kwon, J. Henriksson, J. Luo, and M. C. Wu, \u201cA large-scale microelectromechanical-systems-based silicon photonics LiDAR\u201d, \nNature 603, 253\u2013258 (2022). \n[10] C. Rogers, A. Y. Piggott, D. J. Thomson, R. F. Wiser, I. E. Opris, S. A. Fortune, A. J. Compston, A. Gondarenko, F. Meng, X. Chen, G. T. \nReed, and R. Nicolaescu, \u201cA universal 3D imaging sensor on a silicon photonics platform\u201d, Nature 590, 256\u2013261 (2021). \n[11] F. Eltes, C. Mai, D. Caimi, M. Kroh, Y. Popoff, G. Winzer, D. Petousi, S. Lischke, J. E. Ortmann, L. Czornomaz, L. Zimmermann, J. Fom-\npeyrine, and S. Abel, \u201cA BaTiO3-based electro-optic Pockels modulator monolithically integrated on an advanced silicon photonics platform\u201d, J. \nLight. Technol. 37, 1456\u20131462 (2019). \n[12] K. Alexander, J. P. George, J. Verbist, K. Neyts, B. Kuyken, D. Van Thourhout, and J. Beeckman, \u201cNanophotonic Pockels modulators on a \nsilicon nitride platform\u201d, Nat. Commun. 9, 3444 (2018). \n[13] C. Li, X. Cao, K. Wu, G. Qiu, M. Cai, G. Zhang, X. Li, and J. Chen, \u201cBlind zone-suppressed hybrid beam steering for solid-state LiDAR\u201d, \nPhoton. Res. 9, 1871\u20131880 (2021). \n[14] J. Riemensberger, A. Lukashchuk, M. Karpov, W. Weng, E. Lucas, J. Liu, and T. J. Kippenberg, \u201cMassively parallel coherent laser ranging \nusing a soliton microcomb\u201d, Nature 581, 164\u2013170 (2020). \n[15] H. Shanan, D. Dalton, V. Chillara, and P. Dato, \u201cA 9-to-12GHz coupled-RTWO FMCW ADPLL with 97fs rms jitter, -120dBc/Hz PN at \n1MHz offset, and with retrace time of 12.5 ns and 2 \u03bcs chirp settling time\u201d, in 2022 IEEE International Solid- State Circuits Conference (ISSCC), \nvol. 65 (2022), pp. 146\u2013148. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\n\nResponse: ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 ports\n  - Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports\n  - Grating coupler with 1x1 ports\n  - Edge emitters with 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n```",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725620914.111867",
    "msecs": "111.0",
    "relativeCreated": "960802.7331829071",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback.\nQuery: ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 ports\n  - Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports\n  - Grating coupler with 1x1 ports\n  - Edge emitters with 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n```\nResponse: - The list accurately represents photonic components on the chip.\n- The components listed are relevant and correctly identified as photonic components.\n- No photonic component appears to be missing based on the provided information.\n- The YAML follows the provided template correctly.",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm prompt",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "209",
    "funcName": "_backward_through_llm_base",
    "created": "1725620914.1128645",
    "msecs": "112.0",
    "relativeCreated": "960803.7307262421",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "You will give feedback to a variable with the following role: <ROLE> The yaml file to optimize </ROLE>. Here is an evaluation of the variable using a language model:\n\n<LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 ports\n  - Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports\n  - Grating coupler with 1x1 ports\n  - Edge emitters with 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n``` </LM_INPUT>\n\n<LM_OUTPUT> - The list accurately represents photonic components on the chip.\n- The components listed are relevant and correctly identified as photonic components.\n- No photonic component appears to be missing based on the provided information.\n- The YAML follows the provided template correctly. </LM_OUTPUT>\n\n<OBJECTIVE_FUNCTION>Your goal is to give feedback and criticism to the variable given the above evaluation output. Our only goal is to improve the above metric, and nothing else. </OBJECTIVE_FUNCTION>\n\nWe are interested in giving feedback to the The yaml file to optimize for this conversation. Specifically, give feedback to the following span of text:\n\n<VARIABLE> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with (...) 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n``` </VARIABLE>\n\nGiven the above history, describe how the The yaml file to optimize could be improved to improve the <OBJECTIVE_FUNCTION>. Be very creative, critical, and intelligent.\n\n",
    "message": "_backward_through_llm prompt"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm gradient",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "211",
    "funcName": "_backward_through_llm_base",
    "created": "1725620919.6524217",
    "msecs": "652.0",
    "relativeCreated": "966343.2879447937",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "To improve the YAML file and enhance the evaluation metrics, consider the following feedback:\n\n1. **Component Specificity and Clarity**:\n   - **32-channel Si3N4 switching array with 32x32 ports**: Ensure that the description is precise and unambiguous. For instance, clarify if \"32x32 ports\" refers to input and output ports or another configuration.\n   - **Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports**: Specify if these are tunable or fixed MZI switches, as this can impact the functionality and application.\n   - **Thermo-optics phase shifters with 1x1 ports**: Consider adding details about the range or resolution of the phase shift, which can be crucial for understanding its application.\n   - **Grating coupler with 1x1 ports**: Mention the wavelength range or efficiency of the grating coupler, as these are important parameters.\n   - **Edge emitters with 1x1 ports**: Specify the type of edge emitters (e.g., laser diodes) and their emission characteristics.\n   - **Diffraction transmission grating with 1x1 ports**: Include details about the diffraction efficiency or the specific wavelength range it operates in.\n\n2. **Consistency and Formatting**:\n   - Ensure that the descriptions of each component follow a consistent format. For example, always mention the material (e.g., Si3N4) if relevant, and the configuration (e.g., 32x32 ports) in a uniform manner.\n   - Use a consistent naming convention for ports (e.g., \"1x1 ports\" vs. \"1x1 port\").\n\n3. **Completeness**:\n   - While the evaluation indicates no components are missing, double-check the source article to ensure all relevant photonic components are included. Sometimes, components like waveguides, modulators, or detectors might be overlooked.\n\n4. **Template Adherence**:\n   - Verify that the YAML file strictly adheres to the provided template. If the template specifies additional fields or a particular order, ensure these are followed precisely.\n\n5. **Additional Metadata**:\n   - Consider adding metadata fields if the template allows. For example, fields like `material`, `wavelength_range`, `efficiency`, or `application` can provide more context and improve the comprehensiveness of the summary.\n\nBy addressing these points, the YAML file can be made more precise, comprehensive, and aligned with the evaluation criteria, thereby improving the overall metric.",
    "message": "_backward_through_llm gradient"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent prompt for update",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "165",
    "funcName": "_update_prompt",
    "created": "1725620919.6534197",
    "msecs": "653.0",
    "relativeCreated": "966344.2859649658",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "prompt": "Here is the role of the variable you will improve: <ROLE>The yaml file to optimize</ROLE>.\n\nThe variable is the text within the following span: <VARIABLE> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with (...) 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n``` </VARIABLE>\n\nHere is the context and feedback we got for the variable:\n\n<CONTEXT>Here is a conversation:\n\n<CONVERSATION><LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 ports\n  - Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports\n  - Grating coupler with 1x1 ports\n  - Edge emitters with 1x1 ports\n  - Diffraction transmission grating with 1x1 ports\n``` </LM_INPUT>\n\n<LM_OUTPUT> - The list accurately represents photonic components on the chip.\n- The components listed are relevant and correctly identified as photonic components.\n- No photonic component appears to be missing based on the provided information.\n- The YAML follows the provided template correctly. </LM_OUTPUT>\n\n</CONVERSATION>\n\nThis conversation is potentially part of a larger system. The output is used as response from the language model\n\nHere is the feedback we got for The yaml file to optimize in the conversation:\n\n<FEEDBACK>To improve the YAML file and enhance the evaluation metrics, consider the following feedback:\n\n1. **Component Specificity and Clarity**:\n   - **32-channel Si3N4 switching array with 32x32 ports**: Ensure that the description is precise and unambiguous. For instance, clarify if \"32x32 ports\" refers to input and output ports or another configuration.\n   - **Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports**: Specify if these are tunable or fixed MZI switches, as this can impact the functionality and application.\n   - **Thermo-optics phase shifters with 1x1 ports**: Consider adding details about the range or resolution of the phase shift, which can be crucial for understanding its application.\n   - **Grating coupler with 1x1 ports**: Mention the wavelength range or efficiency of the grating coupler, as these are important parameters.\n   - **Edge emitters with 1x1 ports**: Specify the type of edge emitters (e.g., laser diodes) and their emission characteristics.\n   - **Diffraction transmission grating with 1x1 ports**: Include details about the diffraction efficiency or the specific wavelength range it operates in.\n\n2. **Consistency and Formatting**:\n   - Ensure that the descriptions of each component follow a consistent format. For example, always mention the material (e.g., Si3N4) if relevant, and the configuration (e.g., 32x32 ports) in a uniform manner.\n   - Use a consistent naming convention for ports (e.g., \"1x1 ports\" vs. \"1x1 port\").\n\n3. **Completeness**:\n   - While the evaluation indicates no components are missing, double-check the source article to ensure all relevant photonic components are included. Sometimes, components like waveguides, modulators, or detectors might be overlooked.\n\n4. **Template Adherence**:\n   - Verify that the YAML file strictly adheres to the provided template. If the template specifies additional fields or a particular order, ensure these are followed precisely.\n\n5. **Additional Metadata**:\n   - Consider adding metadata fields if the template allows. For example, fields like `material`, `wavelength_range`, `efficiency`, or `application` can provide more context and improve the comprehensiveness of the summary.\n\nBy addressing these points, the YAML file can be made more precise, comprehensive, and aligned with the evaluation criteria, thereby improving the overall metric.</FEEDBACK>\n\n</CONTEXT>\n\nImprove the variable (The yaml file to optimize) using the feedback provided in <FEEDBACK> tags.\nSend the improved variable in the following format:\n\n<IMPROVED_VARIABLE>{the improved variable}</IMPROVED_VARIABLE>\n\nSend ONLY the improved variable between the <IMPROVED_VARIABLE> tags, and nothing else.",
    "message": "TextualGradientDescent prompt for update"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent optimizer response",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "179",
    "funcName": "step",
    "created": "1725620922.5569983",
    "msecs": "556.0",
    "relativeCreated": "969247.864484787",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "optimizer.response": "<IMPROVED_VARIABLE>```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 input/output ports\n  - Tunable Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports, range: [specify range]\n  - Grating coupler with 1x1 ports, wavelength range: [specify range], efficiency: [specify efficiency]\n  - Edge emitters (laser diodes) with 1x1 ports, emission characteristics: [specify characteristics]\n  - Diffraction transmission grating with 1x1 ports, diffraction efficiency: [specify efficiency], wavelength range: [specify range]\n```</IMPROVED_VARIABLE>",
    "message": "TextualGradientDescent optimizer response"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent updated text",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "187",
    "funcName": "step",
    "created": "1725620922.5579958",
    "msecs": "557.0",
    "relativeCreated": "969248.862028122",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "parameter.value": "```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - 32-channel Si3N4 switching array with 32x32 input/output ports\n  - Tunable Mach\u2013Zehnder interferometer (MZI) switches with 2x2 ports\n  - Thermo-optics phase shifters with 1x1 ports, range: [specify range]\n  - Grating coupler with 1x1 ports, wavelength range: [specify range], efficiency: [specify efficiency]\n  - Edge emitters (laser diodes) with 1x1 ports, emission characteristics: [specify characteristics]\n  - Diffraction transmission grating with 1x1 ports, diffraction efficiency: [specify efficiency], wavelength range: [specify range]\n```",
    "message": "TextualGradientDescent updated text"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725620961.8435526",
    "msecs": "843.0",
    "relativeCreated": "1008534.4188213348",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:None\nQuery: Is this a single academic article, and not a dissertation or collection of papers (single_article)?\nIs the main topic of this article about integrated photonic circuits (topic_photonic)?\nIf yes, find the photonic components that are used on the chip. \nReturn a concise list of these photonic components, if any (components_list).\nFor each component, try to extract: brief spec, \nand the number of optical input and output ports denoted by (input)x(output).\nAnswer in YAML following the template:\nsingle_article: True/False\ntopic_photonic: True/False\ncomponents_list:\n  - a 1x1 modulator with MHz speed\n  - a 1x2 component ...\n  ...\n\nOnly output a YAML text without any preamble like quotations. \n  \nINPUT ARTICLE:\nA Hybrid Solid-State Beam Scanner for FMCW \nLiDAR Application \nZhaoyang Zhang,1 Xufeng Du,2 Zhiyan Zhou,1 Qikai Huang,1 Qiang Zhang,3 \nTingge Dai,1 Hui Yu,1 Yuehai Wang,1 and Jianyi Yang 1, * \n1 College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou 310027, China \n2 Guofeng Electronics, Manzhouli 021400, China \n3 Zhejiang Lab, Hangzhou 311121, China \nAuthor e-mail address: yangjy@zju.edu.cn \nAbstract: We demonstrate a hybrid solid-state beam scanner based on a Si3N4 switching array. \nTwo-dimensional beam steering with a 14.3\u00b0\u00d79.9\u00b0\n field of view and FMCW ranging operation at a \ndistance of 7.4 m are achieved.   \n1. Introduction\nDue to the huge demand brought by the promotion of autonomous driving and robotics, light detection and ranging \n(LiDAR) technology has attracted extensive attention in the past decade. To date, various types of on-chip beam \nscanners have been demonstrated to replace mechanical scanners [1\u20134]. Optical phased arrays on silicon-on-\ninsulator (SOI) provide an attractive method to perform non-mechanical beam steering [5\u20137]. However, it still \nsuffers from the extensive and complex active phase shifting, in order to calibrate the stochastic phase errors in the \narrayed waveguides [8]. Focal plane switching arrays based on silicon photonics platform and MEMS platform \nemerge as an alternative approach due to the advantages of compact size, low power consumption and simple \ncontrol [9,10]. Among them, beam scanners based on Mach\u2013Zehnder interferometer (MZI) abandon the \nmechanical moving parts entirely. In addition, ultra high-speed and low-loss optical switches can be obtained by \nintegrating novel materials with high Pockels coefficients [11,12]. In this work, we demonstrate a hybrid solid-\nstate beam scanner based on a Si3N4 switching array and a blazed grating. The output beam is steered across the \n14.3\u00b0 \u00d7 9.9\u00b0 field of view (FOV) with beam divergence less than 0.1\u00b0. In addition, a ranging distance of 7.4 m is \nachieved by combining the proposed beam scanner and the frequency-modulated continuous-wave (FMCW) \ntechnology. \nFig. 1.  (a) Microscope photograph of the fabricated Si3N4 switching array chip. (b) Schematic of the hybrid \nsolid-state beam scanner. (c) Intensity cuts in \u03b8-direction of 32 separate beams at different angles. (d) \nMeasured beam scanning result and the theoretical value of the transmission grating in \uf06a-direction versus the \nworking wavelength. (e) Two-dimensional beam scanning observed on the screen. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\u00a9 2023 The Author(s)\n \nFig. 2. (a) Experimental setup of the FMCW ranging operation using the beam scanner. (b) The spectrum of \nthe PLL based FMCW synthesizer. (c) and (d) are the time domain and frequency domain signals \ncorresponding to the target of 7.4 m, respectively. (e) Measured beat frequency versus the ranging distance. \n \n2.  Device Fabrication and Beam Steering \nAn optical micrograph of the 32-channel Si3N4 switching array with an overall footprint of 2.2 mm \u00d7 10 mm is \nshown in Fig. 1 (a). The device is fabricated on an 8-inch wafer with a 400 nm-thick PECVD Si3N4 layer by \nAdvanced Micro Foundry. Light is coupled into the chip from a grating coupler. Next, a five-layer binary tree \nformed by cascaded Si3N4 MZI switches routes the incident beam to 32 channels. Thermo-optics phase shifters are \nused to control the on-chip light path. The edge emitters are etched facet inverse tapers with a tip width of 300 nm. \nThe pitch between two adjacent edge emitters is 65 \u00b5m. The schematic of the solid-state beam scanner is depicted in \nFig. 1 (b). Beam emitted from the chip is collimated by an aspherical lens (f = 8.0 mm, NA = 0.5). Then the output \nbeam is aligned to a lithographically patterned diffraction transmission grating (966.18 lines/mm) at the Littrow \nangle. Next, a 45\u00b0 aluminum-coated mirror fixed in the 3D printed mount is used to deflect the beam direction. To \ncharacterize the beam steering, we set a screen in front of the beam scanner at a distance of 2.1 m. An infrared \ncamera records the beam profile on the screen. As shown in Fig. 1 (c), the main beam is steered across a range of \n14.3\u00b0 in \u03b8-direction by toggling the optical switches. Though phase errors still exist in the Si3N4 photonic integrated \ncircuit, the initial phase calibration takes only a few minutes. This problem can be further solved by the real-time \nfeedback control with on-chip power monitors. The angular step between two adjacent points is 0.46\u00b0, which can be \nmuch decreased by enlarging the array size in our future work. A beam steering range of 9.9\u00b0 in the \uf06a-direction is \nachieved by tuning the wavelength from 1500 nm to 1610 nm, as shown in Fig. 1 (d). The steering efficiency thus is \naround 0.09\u00b0/ nm, which is higher than the on-chip Si3N4 grating antenna in [13]. The demand of wideband tunable \nlaser with narrow linewidth still hinders further cost reduction. However, it can be solved by using the massive \ncoherent laser based on the microcomb in [14]. Finally, two-dimensional beam steering is achieved by wavelength \ntuning and switching of channels, as shown in Fig 1. (e). The beam divergency in both directions is measured to be \n< 0.1\u00b0. \n \n3.  FMCW Ranging Operation \nThe setup for FMCW ranging operation is shown in Fig. 2 (a). The FMCW RF signal is provided by the frequency \nsynthesizer based on a fractional-N phased-locked loop (PLL). It generates sawtooth chirps with a period of 1 ms. \nThe chirp range is approximately from 6 GHz to 9 GHz, as shown in Fig. 2 (b). Then the chirped laser light is \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\ngenerated by using an optical single sideband modulator. A 3dB optical power splitter distributes the output of the \nmodulator into two components: one goes straight to the balance detector as the local reference light, and the \nremaining is amplified by an Erbium-doped fiber amplifier (EDFA) as the input of the Si3N4 chip. The backscattered \nlight from the target is collected by a fiber collimator and routed to the balanced detector. An oscillograph records \nthe output of the balanced photodetector and performs real-time FFT analysis. Representative beat signals in the \ntime domain and the frequency domain of a target at 7.4m away are depicted in Fig. 2 (c) and Fig. 2 (d), respectively. \nFigure 2 (e) shows the measured beat frequency when the target distance varies from 0.7 m to 7.4 m. A strong linear \ncorrelation between the beat frequency and the target distance is observed. The slope of the linear fit is around 20.54 \nkHz/m, which is in line with the chirp slope of \u223c 3 MHz/\u00b5s. It is worth noting that the intercept at the frequency \naxis comes from the fixed fiber length difference. The chirp slope can be further increased by using FMCW PLL ICs \n[15], in order to speed up the ranging operation. \n \n4.  Conclusion \nIn conclusion, we demonstrate a hybrid solid-state beam scanner based on the Si3N4 switching array. The \ncombination of the edge emitter and the external transmission grating improves the beam quality as well as the \noptical emission efficiency. Besides, no prism lens with special designs and mechanical moving components exist in \nthe easily implemented beam scanner. Two-dimensional beam steering with a FOV of 14.3\u00b0 \u00d7 9.9\u00b0 is achieved by \nswitch toggling and wavelength tuning. Furthermore, FMCW ranging operation up to 7.4 m is also presented by \nusing the Si3N4 switching array as the transmitter. Our measurements indicate that the proposed hybrid solid-state \nbeam scanner is a scalable and flexible solution for the next-generation FMCW LiDAR. \n \n5.  References \n \n[1] D. N. Hutchison, J. Sun, J. K. Doylend, R. Kumar, J. Heck, W. Kim, C. T. Phare, A. Feshali, and H. Rong, \u201cHigh-resolution aliasing-free \noptical beam steering\u201d, Optica 3, 887\u2013890 (2016). \n[2] H. Ito, Y. Kusunoki, J. Maeda, D. Akiyama, N. Kodama, H. Abe, R. Tetsuya, and T. Baba, \u201cWide beam steering by slow-light waveguide \ngratings and a prism lens\u201d, Optica 7, 47\u201352 (2020). \n[3] J. Park, B. G. Jeong, S. I. Kim, D. Lee, J. Kim, C. Shin, C. B. Lee, T. Otsuka, J. Kyoung, S. Kim, K.-Y. Yang, Y.-Y. Park, J. Lee, I. Hwang, J. \nJang, S. H. Song, M. L. Brongersma, K. Ha, S.-W. Hwang, H. Choo, and B. L. Choi, \u201cAll-solid-state spatial light modulator with independent \nphase and amplitude control for three-dimensional LiDAR applications\u201d, Nat. Nanotechnol. 16, 69\u201376 (2021). \n[4] R. Li, S. Hu, X. Gu, and F. Koyama, \u201cSolid-state slow-light beam scanner with ultra-large field of view and high resolution\u201d, J. Light. \nTechnol. 40, 1855\u20131861 (2022). \n[5] C. V. Poulton, M. J. Byrd, P. Russo, E. Timurdogan, M. Khandaker, D. Vermeulen, and M. R. Watts, \u201cLong-range LiDAR and free-space \ndata communication with high-performance optical phased arrays\u201d, IEEE J. Sel. Top. Quantum Electron. 25, 1\u20138 (2019). \n[6] Y. Li, B. Chen, Q. Na, Q. Xie, M. Tao, L. Zhang, Z. Zhi, Y. Li, X. Liu, X. Luo, G. Lo, F. Gao, X. Li, and J. Song, \u201cWide-steering-angle high-\nresolution optical phased array\u201d, Photon. Res. 9, 2511\u20132518 (2021). \n[7] W. Xu, Y. Guo, X. Li, C. Liu, L. Lu, J. Chen, and L. Zhou, \u201cFully integrated solid-state lidar transmitter on a multi-layer silicon-nitride-on-\nsilicon photonic platform\u201d, J. Light. Technol. pp. 1\u201310 (2022). \n[8] T. Komljenovic and P. Pintus, \u201cOn-chip calibration and control of optical phased arrays\u201d, Opt. Express 26, 3199\u20133210 (2018). \n[9] X. Zhang, K. Kwon, J. Henriksson, J. Luo, and M. C. Wu, \u201cA large-scale microelectromechanical-systems-based silicon photonics LiDAR\u201d, \nNature 603, 253\u2013258 (2022). \n[10] C. Rogers, A. Y. Piggott, D. J. Thomson, R. F. Wiser, I. E. Opris, S. A. Fortune, A. J. Compston, A. Gondarenko, F. Meng, X. Chen, G. T. \nReed, and R. Nicolaescu, \u201cA universal 3D imaging sensor on a silicon photonics platform\u201d, Nature 590, 256\u2013261 (2021). \n[11] F. Eltes, C. Mai, D. Caimi, M. Kroh, Y. Popoff, G. Winzer, D. Petousi, S. Lischke, J. E. Ortmann, L. Czornomaz, L. Zimmermann, J. Fom-\npeyrine, and S. Abel, \u201cA BaTiO3-based electro-optic Pockels modulator monolithically integrated on an advanced silicon photonics platform\u201d, J. \nLight. Technol. 37, 1456\u20131462 (2019). \n[12] K. Alexander, J. P. George, J. Verbist, K. Neyts, B. Kuyken, D. Van Thourhout, and J. Beeckman, \u201cNanophotonic Pockels modulators on a \nsilicon nitride platform\u201d, Nat. Commun. 9, 3444 (2018). \n[13] C. Li, X. Cao, K. Wu, G. Qiu, M. Cai, G. Zhang, X. Li, and J. Chen, \u201cBlind zone-suppressed hybrid beam steering for solid-state LiDAR\u201d, \nPhoton. Res. 9, 1871\u20131880 (2021). \n[14] J. Riemensberger, A. Lukashchuk, M. Karpov, W. Weng, E. Lucas, J. Liu, and T. J. Kippenberg, \u201cMassively parallel coherent laser ranging \nusing a soliton microcomb\u201d, Nature 581, 164\u2013170 (2020). \n[15] H. Shanan, D. Dalton, V. Chillara, and P. Dato, \u201cA 9-to-12GHz coupled-RTWO FMCW ADPLL with 97fs rms jitter, -120dBc/Hz PN at \n1MHz offset, and with retrace time of 12.5 ns and 2 \u03bcs chirp settling time\u201d, in 2022 IEEE International Solid- State Circuits Conference (ISSCC), \nvol. 65 (2022), pp. 146\u2013148. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\n\nResponse: single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array (32 channels) (1)x(32)\n  - Mach\u2013Zehnder interferometer (MZI) switches (1)x(2)\n  - Grating coupler (1)x(1)\n  - Aspherical lens (1)x(1)\n  - Diffraction transmission grating (1)x(1)\n  - Optical single sideband modulator (1)x(1)\n  - 3dB optical power splitter (1)x(2)\n  - Erbium-doped fiber amplifier (EDFA) (1)x(1)\n  - Fiber collimator (1)x(1)\n  - Balanced photodetector (1)x(1)",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725620963.503381",
    "msecs": "503.0",
    "relativeCreated": "1010194.2472457886",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback.\nQuery: single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array (32 channels) (1)x(32)\n  - Mach\u2013Zehnder interferometer (MZI) switches (1)x(2)\n  - Grating coupler (1)x(1)\n  - Aspherical lens (1)x(1)\n  - Diffraction transmission grating (1)x(1)\n  - Optical single sideband modulator (1)x(1)\n  - 3dB optical power splitter (1)x(2)\n  - Erbium-doped fiber amplifier (EDFA) (1)x(1)\n  - Fiber collimator (1)x(1)\n  - Balanced photodetector (1)x(1)\nResponse: - The list includes off-chip components such as the aspherical lens, erbium-doped fiber amplifier (EDFA), and fiber collimator, which should not be included.\n- The list does not accurately represent only the photonic components on the chip.\n- The list includes non-photonic components like the balanced photodetector.\n- The list is not strictly limited to photonic components.\n- The YAML format follows the provided template, but the content does not adhere to the requirement of listing only on-chip photonic components.",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm prompt",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "209",
    "funcName": "_backward_through_llm_base",
    "created": "1725620963.503381",
    "msecs": "503.0",
    "relativeCreated": "1010194.2472457886",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "You will give feedback to a variable with the following role: <ROLE> The yaml file to optimize </ROLE>. Here is an evaluation of the variable using a language model:\n\n<LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array (32 channels) (1)x(32)\n  - Mach\u2013Zehnder interferometer (MZI) switches (1)x(2)\n  - Grating coupler (1)x(1)\n  - Aspherical lens (1)x(1)\n  - Diffraction transmission grating (1)x(1)\n  - Optical single sideband modulator (1)x(1)\n  - 3dB optical power splitter (1)x(2)\n  - Erbium-doped fiber amplifier (EDFA) (1)x(1)\n  - Fiber collimator (1)x(1)\n  - Balanced photodetector (1)x(1) </LM_INPUT>\n\n<LM_OUTPUT> - The list includes off-chip components such as the aspherical lens, erbium-doped fiber amplifier (EDFA), and fiber collimator, which should not be included.\n- The list does not accurately represent only the photonic components on the chip.\n- The list includes non-photonic components like the balanced photodetector.\n- The list is not strictly limited to photonic components.\n- The YAML format follows the provided template, but the content does not adhere to the requirement of listing only on-chip photonic components. </LM_OUTPUT>\n\n<OBJECTIVE_FUNCTION>Your goal is to give feedback and criticism to the variable given the above evaluation output. Our only goal is to improve the above metric, and nothing else. </OBJECTIVE_FUNCTION>\n\nWe are interested in giving feedback to the The yaml file to optimize for this conversation. Specifically, give feedback to the following span of text:\n\n<VARIABLE> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array (32 channels) (...)  - Fiber collimator (1)x(1)\n  - Balanced photodetector (1)x(1) </VARIABLE>\n\nGiven the above history, describe how the The yaml file to optimize could be improved to improve the <OBJECTIVE_FUNCTION>. Be very creative, critical, and intelligent.\n\n",
    "message": "_backward_through_llm prompt"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm gradient",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "211",
    "funcName": "_backward_through_llm_base",
    "created": "1725620967.199721",
    "msecs": "199.0",
    "relativeCreated": "1013890.5873298645",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The evaluation indicates that off-chip components such as the aspherical lens, erbium-doped fiber amplifier (EDFA), and fiber collimator are included. These should be removed to ensure the list only represents photonic components on the chip.\n\n2. **Exclude Non-Photonic Components**: The balanced photodetector is identified as a non-photonic component. Ensure that the list is strictly limited to photonic components by removing such items.\n\n3. **Verify Completeness**: Cross-check the article to ensure that all photonic components on the chip are included. The evaluation does not specify missing components, but a thorough review can help identify any omissions.\n\n4. **Adhere to the Template**: While the YAML format follows the provided template, the content must strictly adhere to the requirement of listing only on-chip photonic components. Ensure that each item in the `components_list` is verified to be an on-chip photonic component.\n\n5. **Clarify Component Descriptions**: Ensure that the descriptions of the components are clear and unambiguous. This can help in verifying whether they are on-chip and photonic.\n\n6. **Consistency in Notation**: Maintain a consistent notation for the components. For example, use a uniform format for specifying the number of channels or instances.\n\nBy addressing these points, the YAML file can be optimized to accurately represent only the photonic components on the chip, thereby improving the evaluation metrics.",
    "message": "_backward_through_llm gradient"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent prompt for update",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "165",
    "funcName": "_update_prompt",
    "created": "1725620967.2007172",
    "msecs": "200.0",
    "relativeCreated": "1013891.583442688",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "prompt": "Here is the role of the variable you will improve: <ROLE>The yaml file to optimize</ROLE>.\n\nThe variable is the text within the following span: <VARIABLE> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array (32 channels) (...)  - Fiber collimator (1)x(1)\n  - Balanced photodetector (1)x(1) </VARIABLE>\n\nHere is the context and feedback we got for the variable:\n\n<CONTEXT>Here is a conversation:\n\n<CONVERSATION><LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array (32 channels) (1)x(32)\n  - Mach\u2013Zehnder interferometer (MZI) switches (1)x(2)\n  - Grating coupler (1)x(1)\n  - Aspherical lens (1)x(1)\n  - Diffraction transmission grating (1)x(1)\n  - Optical single sideband modulator (1)x(1)\n  - 3dB optical power splitter (1)x(2)\n  - Erbium-doped fiber amplifier (EDFA) (1)x(1)\n  - Fiber collimator (1)x(1)\n  - Balanced photodetector (1)x(1) </LM_INPUT>\n\n<LM_OUTPUT> - The list includes off-chip components such as the aspherical lens, erbium-doped fiber amplifier (EDFA), and fiber collimator, which should not be included.\n- The list does not accurately represent only the photonic components on the chip.\n- The list includes non-photonic components like the balanced photodetector.\n- The list is not strictly limited to photonic components.\n- The YAML format follows the provided template, but the content does not adhere to the requirement of listing only on-chip photonic components. </LM_OUTPUT>\n\n</CONVERSATION>\n\nThis conversation is potentially part of a larger system. The output is used as response from the language model\n\nHere is the feedback we got for The yaml file to optimize in the conversation:\n\n<FEEDBACK>To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The evaluation indicates that off-chip components such as the aspherical lens, erbium-doped fiber amplifier (EDFA), and fiber collimator are included. These should be removed to ensure the list only represents photonic components on the chip.\n\n2. **Exclude Non-Photonic Components**: The balanced photodetector is identified as a non-photonic component. Ensure that the list is strictly limited to photonic components by removing such items.\n\n3. **Verify Completeness**: Cross-check the article to ensure that all photonic components on the chip are included. The evaluation does not specify missing components, but a thorough review can help identify any omissions.\n\n4. **Adhere to the Template**: While the YAML format follows the provided template, the content must strictly adhere to the requirement of listing only on-chip photonic components. Ensure that each item in the `components_list` is verified to be an on-chip photonic component.\n\n5. **Clarify Component Descriptions**: Ensure that the descriptions of the components are clear and unambiguous. This can help in verifying whether they are on-chip and photonic.\n\n6. **Consistency in Notation**: Maintain a consistent notation for the components. For example, use a uniform format for specifying the number of channels or instances.\n\nBy addressing these points, the YAML file can be optimized to accurately represent only the photonic components on the chip, thereby improving the evaluation metrics.</FEEDBACK>\n\n</CONTEXT>\n\nImprove the variable (The yaml file to optimize) using the feedback provided in <FEEDBACK> tags.\nSend the improved variable in the following format:\n\n<IMPROVED_VARIABLE>{the improved variable}</IMPROVED_VARIABLE>\n\nSend ONLY the improved variable between the <IMPROVED_VARIABLE> tags, and nothing else.",
    "message": "TextualGradientDescent prompt for update"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent optimizer response",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "179",
    "funcName": "step",
    "created": "1725620969.4610238",
    "msecs": "461.0",
    "relativeCreated": "1016151.890039444",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "optimizer.response": "<IMPROVED_VARIABLE>\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array (32 channels) (1)x(32)\n  - Mach\u2013Zehnder interferometer (MZI) switches (1)x(2)\n  - Grating coupler (1)x(1)\n  - Diffraction transmission grating (1)x(1)\n  - Optical single sideband modulator (1)x(1)\n  - 3dB optical power splitter (1)x(2)\n</IMPROVED_VARIABLE>",
    "message": "TextualGradientDescent optimizer response"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent updated text",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "187",
    "funcName": "step",
    "created": "1725620969.4610238",
    "msecs": "461.0",
    "relativeCreated": "1016151.890039444",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "parameter.value": "single_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array (32 channels) (1)x(32)\n  - Mach\u2013Zehnder interferometer (MZI) switches (1)x(2)\n  - Grating coupler (1)x(1)\n  - Diffraction transmission grating (1)x(1)\n  - Optical single sideband modulator (1)x(1)\n  - 3dB optical power splitter (1)x(2)",
    "message": "TextualGradientDescent updated text"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725621020.786894",
    "msecs": "786.0",
    "relativeCreated": "1067477.7603149414",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:None\nQuery: Is this a single academic article, and not a dissertation or collection of papers (single_article)?\nIs the main topic of this article about integrated photonic circuits (topic_photonic)?\nIf yes, find the photonic components that are used on the chip. \nReturn a concise list of these photonic components, if any (components_list).\nFor each component, try to extract: brief spec, \nand the number of optical input (N) and output (M) ports denoted by NxM, e.g. 1x2.\nAnswer in YAML following the template:\nsingle_article: True/False\ntopic_photonic: True/False\ncomponents_list:\n  - a 1x1 modulator with MHz speed\n  - a 1x2 component ...\n  ...\n\nOnly output a YAML text without any preamble like quotations. \n  \nINPUT ARTICLE:\nA Hybrid Solid-State Beam Scanner for FMCW \nLiDAR Application \nZhaoyang Zhang,1 Xufeng Du,2 Zhiyan Zhou,1 Qikai Huang,1 Qiang Zhang,3 \nTingge Dai,1 Hui Yu,1 Yuehai Wang,1 and Jianyi Yang 1, * \n1 College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou 310027, China \n2 Guofeng Electronics, Manzhouli 021400, China \n3 Zhejiang Lab, Hangzhou 311121, China \nAuthor e-mail address: yangjy@zju.edu.cn \nAbstract: We demonstrate a hybrid solid-state beam scanner based on a Si3N4 switching array. \nTwo-dimensional beam steering with a 14.3\u00b0\u00d79.9\u00b0\n field of view and FMCW ranging operation at a \ndistance of 7.4 m are achieved.   \n1. Introduction\nDue to the huge demand brought by the promotion of autonomous driving and robotics, light detection and ranging \n(LiDAR) technology has attracted extensive attention in the past decade. To date, various types of on-chip beam \nscanners have been demonstrated to replace mechanical scanners [1\u20134]. Optical phased arrays on silicon-on-\ninsulator (SOI) provide an attractive method to perform non-mechanical beam steering [5\u20137]. However, it still \nsuffers from the extensive and complex active phase shifting, in order to calibrate the stochastic phase errors in the \narrayed waveguides [8]. Focal plane switching arrays based on silicon photonics platform and MEMS platform \nemerge as an alternative approach due to the advantages of compact size, low power consumption and simple \ncontrol [9,10]. Among them, beam scanners based on Mach\u2013Zehnder interferometer (MZI) abandon the \nmechanical moving parts entirely. In addition, ultra high-speed and low-loss optical switches can be obtained by \nintegrating novel materials with high Pockels coefficients [11,12]. In this work, we demonstrate a hybrid solid-\nstate beam scanner based on a Si3N4 switching array and a blazed grating. The output beam is steered across the \n14.3\u00b0 \u00d7 9.9\u00b0 field of view (FOV) with beam divergence less than 0.1\u00b0. In addition, a ranging distance of 7.4 m is \nachieved by combining the proposed beam scanner and the frequency-modulated continuous-wave (FMCW) \ntechnology. \nFig. 1.  (a) Microscope photograph of the fabricated Si3N4 switching array chip. (b) Schematic of the hybrid \nsolid-state beam scanner. (c) Intensity cuts in \u03b8-direction of 32 separate beams at different angles. (d) \nMeasured beam scanning result and the theoretical value of the transmission grating in \uf06a-direction versus the \nworking wavelength. (e) Two-dimensional beam scanning observed on the screen. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\u00a9 2023 The Author(s)\n \nFig. 2. (a) Experimental setup of the FMCW ranging operation using the beam scanner. (b) The spectrum of \nthe PLL based FMCW synthesizer. (c) and (d) are the time domain and frequency domain signals \ncorresponding to the target of 7.4 m, respectively. (e) Measured beat frequency versus the ranging distance. \n \n2.  Device Fabrication and Beam Steering \nAn optical micrograph of the 32-channel Si3N4 switching array with an overall footprint of 2.2 mm \u00d7 10 mm is \nshown in Fig. 1 (a). The device is fabricated on an 8-inch wafer with a 400 nm-thick PECVD Si3N4 layer by \nAdvanced Micro Foundry. Light is coupled into the chip from a grating coupler. Next, a five-layer binary tree \nformed by cascaded Si3N4 MZI switches routes the incident beam to 32 channels. Thermo-optics phase shifters are \nused to control the on-chip light path. The edge emitters are etched facet inverse tapers with a tip width of 300 nm. \nThe pitch between two adjacent edge emitters is 65 \u00b5m. The schematic of the solid-state beam scanner is depicted in \nFig. 1 (b). Beam emitted from the chip is collimated by an aspherical lens (f = 8.0 mm, NA = 0.5). Then the output \nbeam is aligned to a lithographically patterned diffraction transmission grating (966.18 lines/mm) at the Littrow \nangle. Next, a 45\u00b0 aluminum-coated mirror fixed in the 3D printed mount is used to deflect the beam direction. To \ncharacterize the beam steering, we set a screen in front of the beam scanner at a distance of 2.1 m. An infrared \ncamera records the beam profile on the screen. As shown in Fig. 1 (c), the main beam is steered across a range of \n14.3\u00b0 in \u03b8-direction by toggling the optical switches. Though phase errors still exist in the Si3N4 photonic integrated \ncircuit, the initial phase calibration takes only a few minutes. This problem can be further solved by the real-time \nfeedback control with on-chip power monitors. The angular step between two adjacent points is 0.46\u00b0, which can be \nmuch decreased by enlarging the array size in our future work. A beam steering range of 9.9\u00b0 in the \uf06a-direction is \nachieved by tuning the wavelength from 1500 nm to 1610 nm, as shown in Fig. 1 (d). The steering efficiency thus is \naround 0.09\u00b0/ nm, which is higher than the on-chip Si3N4 grating antenna in [13]. The demand of wideband tunable \nlaser with narrow linewidth still hinders further cost reduction. However, it can be solved by using the massive \ncoherent laser based on the microcomb in [14]. Finally, two-dimensional beam steering is achieved by wavelength \ntuning and switching of channels, as shown in Fig 1. (e). The beam divergency in both directions is measured to be \n< 0.1\u00b0. \n \n3.  FMCW Ranging Operation \nThe setup for FMCW ranging operation is shown in Fig. 2 (a). The FMCW RF signal is provided by the frequency \nsynthesizer based on a fractional-N phased-locked loop (PLL). It generates sawtooth chirps with a period of 1 ms. \nThe chirp range is approximately from 6 GHz to 9 GHz, as shown in Fig. 2 (b). Then the chirped laser light is \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\ngenerated by using an optical single sideband modulator. A 3dB optical power splitter distributes the output of the \nmodulator into two components: one goes straight to the balance detector as the local reference light, and the \nremaining is amplified by an Erbium-doped fiber amplifier (EDFA) as the input of the Si3N4 chip. The backscattered \nlight from the target is collected by a fiber collimator and routed to the balanced detector. An oscillograph records \nthe output of the balanced photodetector and performs real-time FFT analysis. Representative beat signals in the \ntime domain and the frequency domain of a target at 7.4m away are depicted in Fig. 2 (c) and Fig. 2 (d), respectively. \nFigure 2 (e) shows the measured beat frequency when the target distance varies from 0.7 m to 7.4 m. A strong linear \ncorrelation between the beat frequency and the target distance is observed. The slope of the linear fit is around 20.54 \nkHz/m, which is in line with the chirp slope of \u223c 3 MHz/\u00b5s. It is worth noting that the intercept at the frequency \naxis comes from the fixed fiber length difference. The chirp slope can be further increased by using FMCW PLL ICs \n[15], in order to speed up the ranging operation. \n \n4.  Conclusion \nIn conclusion, we demonstrate a hybrid solid-state beam scanner based on the Si3N4 switching array. The \ncombination of the edge emitter and the external transmission grating improves the beam quality as well as the \noptical emission efficiency. Besides, no prism lens with special designs and mechanical moving components exist in \nthe easily implemented beam scanner. Two-dimensional beam steering with a FOV of 14.3\u00b0 \u00d7 9.9\u00b0 is achieved by \nswitch toggling and wavelength tuning. Furthermore, FMCW ranging operation up to 7.4 m is also presented by \nusing the Si3N4 switching array as the transmitter. Our measurements indicate that the proposed hybrid solid-state \nbeam scanner is a scalable and flexible solution for the next-generation FMCW LiDAR. \n \n5.  References \n \n[1] D. N. Hutchison, J. Sun, J. K. Doylend, R. Kumar, J. Heck, W. Kim, C. T. Phare, A. Feshali, and H. Rong, \u201cHigh-resolution aliasing-free \noptical beam steering\u201d, Optica 3, 887\u2013890 (2016). \n[2] H. Ito, Y. Kusunoki, J. Maeda, D. Akiyama, N. Kodama, H. Abe, R. Tetsuya, and T. Baba, \u201cWide beam steering by slow-light waveguide \ngratings and a prism lens\u201d, Optica 7, 47\u201352 (2020). \n[3] J. Park, B. G. Jeong, S. I. Kim, D. Lee, J. Kim, C. Shin, C. B. Lee, T. Otsuka, J. Kyoung, S. Kim, K.-Y. Yang, Y.-Y. Park, J. Lee, I. Hwang, J. \nJang, S. H. Song, M. L. Brongersma, K. Ha, S.-W. Hwang, H. Choo, and B. L. Choi, \u201cAll-solid-state spatial light modulator with independent \nphase and amplitude control for three-dimensional LiDAR applications\u201d, Nat. Nanotechnol. 16, 69\u201376 (2021). \n[4] R. Li, S. Hu, X. Gu, and F. Koyama, \u201cSolid-state slow-light beam scanner with ultra-large field of view and high resolution\u201d, J. Light. \nTechnol. 40, 1855\u20131861 (2022). \n[5] C. V. Poulton, M. J. Byrd, P. Russo, E. Timurdogan, M. Khandaker, D. Vermeulen, and M. R. Watts, \u201cLong-range LiDAR and free-space \ndata communication with high-performance optical phased arrays\u201d, IEEE J. Sel. Top. Quantum Electron. 25, 1\u20138 (2019). \n[6] Y. Li, B. Chen, Q. Na, Q. Xie, M. Tao, L. Zhang, Z. Zhi, Y. Li, X. Liu, X. Luo, G. Lo, F. Gao, X. Li, and J. Song, \u201cWide-steering-angle high-\nresolution optical phased array\u201d, Photon. Res. 9, 2511\u20132518 (2021). \n[7] W. Xu, Y. Guo, X. Li, C. Liu, L. Lu, J. Chen, and L. Zhou, \u201cFully integrated solid-state lidar transmitter on a multi-layer silicon-nitride-on-\nsilicon photonic platform\u201d, J. Light. Technol. pp. 1\u201310 (2022). \n[8] T. Komljenovic and P. Pintus, \u201cOn-chip calibration and control of optical phased arrays\u201d, Opt. Express 26, 3199\u20133210 (2018). \n[9] X. Zhang, K. Kwon, J. Henriksson, J. Luo, and M. C. Wu, \u201cA large-scale microelectromechanical-systems-based silicon photonics LiDAR\u201d, \nNature 603, 253\u2013258 (2022). \n[10] C. Rogers, A. Y. Piggott, D. J. Thomson, R. F. Wiser, I. E. Opris, S. A. Fortune, A. J. Compston, A. Gondarenko, F. Meng, X. Chen, G. T. \nReed, and R. Nicolaescu, \u201cA universal 3D imaging sensor on a silicon photonics platform\u201d, Nature 590, 256\u2013261 (2021). \n[11] F. Eltes, C. Mai, D. Caimi, M. Kroh, Y. Popoff, G. Winzer, D. Petousi, S. Lischke, J. E. Ortmann, L. Czornomaz, L. Zimmermann, J. Fom-\npeyrine, and S. Abel, \u201cA BaTiO3-based electro-optic Pockels modulator monolithically integrated on an advanced silicon photonics platform\u201d, J. \nLight. Technol. 37, 1456\u20131462 (2019). \n[12] K. Alexander, J. P. George, J. Verbist, K. Neyts, B. Kuyken, D. Van Thourhout, and J. Beeckman, \u201cNanophotonic Pockels modulators on a \nsilicon nitride platform\u201d, Nat. Commun. 9, 3444 (2018). \n[13] C. Li, X. Cao, K. Wu, G. Qiu, M. Cai, G. Zhang, X. Li, and J. Chen, \u201cBlind zone-suppressed hybrid beam steering for solid-state LiDAR\u201d, \nPhoton. Res. 9, 1871\u20131880 (2021). \n[14] J. Riemensberger, A. Lukashchuk, M. Karpov, W. Weng, E. Lucas, J. Liu, and T. J. Kippenberg, \u201cMassively parallel coherent laser ranging \nusing a soliton microcomb\u201d, Nature 581, 164\u2013170 (2020). \n[15] H. Shanan, D. Dalton, V. Chillara, and P. Dato, \u201cA 9-to-12GHz coupled-RTWO FMCW ADPLL with 97fs rms jitter, -120dBc/Hz PN at \n1MHz offset, and with retrace time of 12.5 ns and 2 \u03bcs chirp settling time\u201d, in 2022 IEEE International Solid- State Circuits Conference (ISSCC), \nvol. 65 (2022), pp. 146\u2013148. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\n\nResponse: ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array: 32x1\n  - Mach\u2013Zehnder interferometer (MZI): 1x2\n  - Grating coupler: 1x1\n  - Aspherical lens: 1x1\n  - Diffraction transmission grating: 1x1\n  - Optical single sideband modulator: 1x1\n  - 3dB optical power splitter: 1x2\n  - Erbium-doped fiber amplifier (EDFA): 1x1\n  - Fiber collimator: 1x1\n```",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725621022.9463158",
    "msecs": "946.0",
    "relativeCreated": "1069637.1819972992",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback.\nQuery: ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array: 32x1\n  - Mach\u2013Zehnder interferometer (MZI): 1x2\n  - Grating coupler: 1x1\n  - Aspherical lens: 1x1\n  - Diffraction transmission grating: 1x1\n  - Optical single sideband modulator: 1x1\n  - 3dB optical power splitter: 1x2\n  - Erbium-doped fiber amplifier (EDFA): 1x1\n  - Fiber collimator: 1x1\n```\nResponse: - The list includes components that are not on-chip photonic components, such as the Aspherical lens, Diffraction transmission grating, Erbium-doped fiber amplifier (EDFA), and Fiber collimator.\n- The list does not accurately represent only the photonic components on the chip.\n- The list may be missing other on-chip photonic components that were mentioned in the article.\n- The YAML file does not strictly follow the requirement of listing only on-chip photonic components.\n\nConcise feedback: The YAML file includes off-chip components and may be missing some on-chip photonic components. It should be revised to list only the photonic components on the chip.",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm prompt",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "209",
    "funcName": "_backward_through_llm_base",
    "created": "1725621022.9463158",
    "msecs": "946.0",
    "relativeCreated": "1069637.1819972992",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "You will give feedback to a variable with the following role: <ROLE> The yaml file to optimize </ROLE>. Here is an evaluation of the variable using a language model:\n\n<LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array: 32x1\n  - Mach\u2013Zehnder interferometer (MZI): 1x2\n  - Grating coupler: 1x1\n  - Aspherical lens: 1x1\n  - Diffraction transmission grating: 1x1\n  - Optical single sideband modulator: 1x1\n  - 3dB optical power splitter: 1x2\n  - Erbium-doped fiber amplifier (EDFA): 1x1\n  - Fiber collimator: 1x1\n``` </LM_INPUT>\n\n<LM_OUTPUT> - The list includes components that are not on-chip photonic components, such as the Aspherical lens, Diffraction transmission grating, Erbium-doped fiber amplifier (EDFA), and Fiber collimator.\n- The list does not accurately represent only the photonic components on the chip.\n- The list may be missing other on-chip photonic components that were mentioned in the article.\n- The YAML file does not strictly follow the requirement of listing only on-chip photonic components.\n\nConcise feedback: The YAML file includes off-chip components and may be missing some on-chip photonic components. It should be revised to list only the photonic components on the chip. </LM_OUTPUT>\n\n<OBJECTIVE_FUNCTION>Your goal is to give feedback and criticism to the variable given the above evaluation output. Our only goal is to improve the above metric, and nothing else. </OBJECTIVE_FUNCTION>\n\nWe are interested in giving feedback to the The yaml file to optimize for this conversation. Specifically, give feedback to the following span of text:\n\n<VARIABLE> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array: 32x1\n  (...) Erbium-doped fiber amplifier (EDFA): 1x1\n  - Fiber collimator: 1x1\n``` </VARIABLE>\n\nGiven the above history, describe how the The yaml file to optimize could be improved to improve the <OBJECTIVE_FUNCTION>. Be very creative, critical, and intelligent.\n\n",
    "message": "_backward_through_llm prompt"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm gradient",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "211",
    "funcName": "_backward_through_llm_base",
    "created": "1725621026.571187",
    "msecs": "571.0",
    "relativeCreated": "1073262.0532512665",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The YAML file currently includes components that are not on-chip photonic components. Specifically, the following items should be removed:\n   - Aspherical lens\n   - Diffraction transmission grating\n   - Erbium-doped fiber amplifier (EDFA)\n   - Fiber collimator\n\n   Removing these components will ensure that the list only includes on-chip photonic components.\n\n2. **Verify Completeness**: The evaluation suggests that the list may be missing some on-chip photonic components mentioned in the article. Review the article thoroughly to ensure that all relevant on-chip photonic components are included in the list. This will improve the accuracy and completeness of the YAML file.\n\n3. **Adhere to the Template**: Ensure that the YAML file strictly follows the provided template. The template requires a list of only on-chip photonic components. Double-check the format and structure to ensure compliance.\n\n4. **Component Naming Consistency**: Ensure that the names of the components are consistent with the terminology used in the article. This will help in accurately representing the photonic components and avoiding any confusion.\n\n5. **Double-Check Quantities and Configurations**: Verify that the quantities and configurations (e.g., 32x1, 1x2) of the components are accurately represented as per the article. Any discrepancies should be corrected to reflect the true specifications.\n\nBy addressing these points, the YAML file will better meet the objective of accurately summarizing the on-chip photonic components presented in the input article.",
    "message": "_backward_through_llm gradient"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent prompt for update",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "165",
    "funcName": "_update_prompt",
    "created": "1725621026.571187",
    "msecs": "571.0",
    "relativeCreated": "1073262.0532512665",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "prompt": "Here is the role of the variable you will improve: <ROLE>The yaml file to optimize</ROLE>.\n\nThe variable is the text within the following span: <VARIABLE> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array: 32x1\n  (...) Erbium-doped fiber amplifier (EDFA): 1x1\n  - Fiber collimator: 1x1\n``` </VARIABLE>\n\nHere is the context and feedback we got for the variable:\n\n<CONTEXT>Here is a conversation:\n\n<CONVERSATION><LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> ```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array: 32x1\n  - Mach\u2013Zehnder interferometer (MZI): 1x2\n  - Grating coupler: 1x1\n  - Aspherical lens: 1x1\n  - Diffraction transmission grating: 1x1\n  - Optical single sideband modulator: 1x1\n  - 3dB optical power splitter: 1x2\n  - Erbium-doped fiber amplifier (EDFA): 1x1\n  - Fiber collimator: 1x1\n``` </LM_INPUT>\n\n<LM_OUTPUT> - The list includes components that are not on-chip photonic components, such as the Aspherical lens, Diffraction transmission grating, Erbium-doped fiber amplifier (EDFA), and Fiber collimator.\n- The list does not accurately represent only the photonic components on the chip.\n- The list may be missing other on-chip photonic components that were mentioned in the article.\n- The YAML file does not strictly follow the requirement of listing only on-chip photonic components.\n\nConcise feedback: The YAML file includes off-chip components and may be missing some on-chip photonic components. It should be revised to list only the photonic components on the chip. </LM_OUTPUT>\n\n</CONVERSATION>\n\nThis conversation is potentially part of a larger system. The output is used as response from the language model\n\nHere is the feedback we got for The yaml file to optimize in the conversation:\n\n<FEEDBACK>To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The YAML file currently includes components that are not on-chip photonic components. Specifically, the following items should be removed:\n   - Aspherical lens\n   - Diffraction transmission grating\n   - Erbium-doped fiber amplifier (EDFA)\n   - Fiber collimator\n\n   Removing these components will ensure that the list only includes on-chip photonic components.\n\n2. **Verify Completeness**: The evaluation suggests that the list may be missing some on-chip photonic components mentioned in the article. Review the article thoroughly to ensure that all relevant on-chip photonic components are included in the list. This will improve the accuracy and completeness of the YAML file.\n\n3. **Adhere to the Template**: Ensure that the YAML file strictly follows the provided template. The template requires a list of only on-chip photonic components. Double-check the format and structure to ensure compliance.\n\n4. **Component Naming Consistency**: Ensure that the names of the components are consistent with the terminology used in the article. This will help in accurately representing the photonic components and avoiding any confusion.\n\n5. **Double-Check Quantities and Configurations**: Verify that the quantities and configurations (e.g., 32x1, 1x2) of the components are accurately represented as per the article. Any discrepancies should be corrected to reflect the true specifications.\n\nBy addressing these points, the YAML file will better meet the objective of accurately summarizing the on-chip photonic components presented in the input article.</FEEDBACK>\n\n</CONTEXT>\n\nImprove the variable (The yaml file to optimize) using the feedback provided in <FEEDBACK> tags.\nSend the improved variable in the following format:\n\n<IMPROVED_VARIABLE>{the improved variable}</IMPROVED_VARIABLE>\n\nSend ONLY the improved variable between the <IMPROVED_VARIABLE> tags, and nothing else.",
    "message": "TextualGradientDescent prompt for update"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent optimizer response",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "179",
    "funcName": "step",
    "created": "1725621028.5077403",
    "msecs": "507.0",
    "relativeCreated": "1075198.6064910889",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "optimizer.response": "<IMPROVED_VARIABLE>```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array: 32x1\n  - Mach\u2013Zehnder interferometer (MZI): 1x2\n  - Grating coupler: 1x1\n  - Optical single sideband modulator: 1x1\n  - 3dB optical power splitter: 1x2\n```</IMPROVED_VARIABLE>",
    "message": "TextualGradientDescent optimizer response"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent updated text",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "187",
    "funcName": "step",
    "created": "1725621028.5077403",
    "msecs": "507.0",
    "relativeCreated": "1075198.6064910889",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "parameter.value": "```yaml\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - Si3N4 switching array: 32x1\n  - Mach\u2013Zehnder interferometer (MZI): 1x2\n  - Grating coupler: 1x1\n  - Optical single sideband modulator: 1x1\n  - 3dB optical power splitter: 1x2\n```",
    "message": "TextualGradientDescent updated text"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725621094.9052062",
    "msecs": "905.0",
    "relativeCreated": "1141596.072435379",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:None\nQuery: Is this a single academic article, and not a dissertation or collection of papers (single_article)?\nIs the main topic of this article about integrated photonic circuits (topic_photonic)?\nIf yes, find the photonic components that are used on the chip. \nReturn a concise list of these photonic components, if any (components_list).\nFor each component, try to extract: brief spec, \nand the number of optical input (N) and output (M) ports denoted by NxM, e.g. 1x2.\nAnswer in YAML following the template:\nsingle_article: True/False\ntopic_photonic: True/False\ncomponents_list:\n  - a 1x1 modulator with MHz speed\n  - a 1x2 component ...\n  ...\n\nOnly output a YAML text without any preamble like quotations. \n  \nINPUT ARTICLE:\nA Hybrid Solid-State Beam Scanner for FMCW \nLiDAR Application \nZhaoyang Zhang,1 Xufeng Du,2 Zhiyan Zhou,1 Qikai Huang,1 Qiang Zhang,3 \nTingge Dai,1 Hui Yu,1 Yuehai Wang,1 and Jianyi Yang 1, * \n1 College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou 310027, China \n2 Guofeng Electronics, Manzhouli 021400, China \n3 Zhejiang Lab, Hangzhou 311121, China \nAuthor e-mail address: yangjy@zju.edu.cn \nAbstract: We demonstrate a hybrid solid-state beam scanner based on a Si3N4 switching array. \nTwo-dimensional beam steering with a 14.3\u00b0\u00d79.9\u00b0\n field of view and FMCW ranging operation at a \ndistance of 7.4 m are achieved.   \n1. Introduction\nDue to the huge demand brought by the promotion of autonomous driving and robotics, light detection and ranging \n(LiDAR) technology has attracted extensive attention in the past decade. To date, various types of on-chip beam \nscanners have been demonstrated to replace mechanical scanners [1\u20134]. Optical phased arrays on silicon-on-\ninsulator (SOI) provide an attractive method to perform non-mechanical beam steering [5\u20137]. However, it still \nsuffers from the extensive and complex active phase shifting, in order to calibrate the stochastic phase errors in the \narrayed waveguides [8]. Focal plane switching arrays based on silicon photonics platform and MEMS platform \nemerge as an alternative approach due to the advantages of compact size, low power consumption and simple \ncontrol [9,10]. Among them, beam scanners based on Mach\u2013Zehnder interferometer (MZI) abandon the \nmechanical moving parts entirely. In addition, ultra high-speed and low-loss optical switches can be obtained by \nintegrating novel materials with high Pockels coefficients [11,12]. In this work, we demonstrate a hybrid solid-\nstate beam scanner based on a Si3N4 switching array and a blazed grating. The output beam is steered across the \n14.3\u00b0 \u00d7 9.9\u00b0 field of view (FOV) with beam divergence less than 0.1\u00b0. In addition, a ranging distance of 7.4 m is \nachieved by combining the proposed beam scanner and the frequency-modulated continuous-wave (FMCW) \ntechnology. \nFig. 1.  (a) Microscope photograph of the fabricated Si3N4 switching array chip. (b) Schematic of the hybrid \nsolid-state beam scanner. (c) Intensity cuts in \u03b8-direction of 32 separate beams at different angles. (d) \nMeasured beam scanning result and the theoretical value of the transmission grating in \uf06a-direction versus the \nworking wavelength. (e) Two-dimensional beam scanning observed on the screen. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\u00a9 2023 The Author(s)\n \nFig. 2. (a) Experimental setup of the FMCW ranging operation using the beam scanner. (b) The spectrum of \nthe PLL based FMCW synthesizer. (c) and (d) are the time domain and frequency domain signals \ncorresponding to the target of 7.4 m, respectively. (e) Measured beat frequency versus the ranging distance. \n \n2.  Device Fabrication and Beam Steering \nAn optical micrograph of the 32-channel Si3N4 switching array with an overall footprint of 2.2 mm \u00d7 10 mm is \nshown in Fig. 1 (a). The device is fabricated on an 8-inch wafer with a 400 nm-thick PECVD Si3N4 layer by \nAdvanced Micro Foundry. Light is coupled into the chip from a grating coupler. Next, a five-layer binary tree \nformed by cascaded Si3N4 MZI switches routes the incident beam to 32 channels. Thermo-optics phase shifters are \nused to control the on-chip light path. The edge emitters are etched facet inverse tapers with a tip width of 300 nm. \nThe pitch between two adjacent edge emitters is 65 \u00b5m. The schematic of the solid-state beam scanner is depicted in \nFig. 1 (b). Beam emitted from the chip is collimated by an aspherical lens (f = 8.0 mm, NA = 0.5). Then the output \nbeam is aligned to a lithographically patterned diffraction transmission grating (966.18 lines/mm) at the Littrow \nangle. Next, a 45\u00b0 aluminum-coated mirror fixed in the 3D printed mount is used to deflect the beam direction. To \ncharacterize the beam steering, we set a screen in front of the beam scanner at a distance of 2.1 m. An infrared \ncamera records the beam profile on the screen. As shown in Fig. 1 (c), the main beam is steered across a range of \n14.3\u00b0 in \u03b8-direction by toggling the optical switches. Though phase errors still exist in the Si3N4 photonic integrated \ncircuit, the initial phase calibration takes only a few minutes. This problem can be further solved by the real-time \nfeedback control with on-chip power monitors. The angular step between two adjacent points is 0.46\u00b0, which can be \nmuch decreased by enlarging the array size in our future work. A beam steering range of 9.9\u00b0 in the \uf06a-direction is \nachieved by tuning the wavelength from 1500 nm to 1610 nm, as shown in Fig. 1 (d). The steering efficiency thus is \naround 0.09\u00b0/ nm, which is higher than the on-chip Si3N4 grating antenna in [13]. The demand of wideband tunable \nlaser with narrow linewidth still hinders further cost reduction. However, it can be solved by using the massive \ncoherent laser based on the microcomb in [14]. Finally, two-dimensional beam steering is achieved by wavelength \ntuning and switching of channels, as shown in Fig 1. (e). The beam divergency in both directions is measured to be \n< 0.1\u00b0. \n \n3.  FMCW Ranging Operation \nThe setup for FMCW ranging operation is shown in Fig. 2 (a). The FMCW RF signal is provided by the frequency \nsynthesizer based on a fractional-N phased-locked loop (PLL). It generates sawtooth chirps with a period of 1 ms. \nThe chirp range is approximately from 6 GHz to 9 GHz, as shown in Fig. 2 (b). Then the chirped laser light is \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\ngenerated by using an optical single sideband modulator. A 3dB optical power splitter distributes the output of the \nmodulator into two components: one goes straight to the balance detector as the local reference light, and the \nremaining is amplified by an Erbium-doped fiber amplifier (EDFA) as the input of the Si3N4 chip. The backscattered \nlight from the target is collected by a fiber collimator and routed to the balanced detector. An oscillograph records \nthe output of the balanced photodetector and performs real-time FFT analysis. Representative beat signals in the \ntime domain and the frequency domain of a target at 7.4m away are depicted in Fig. 2 (c) and Fig. 2 (d), respectively. \nFigure 2 (e) shows the measured beat frequency when the target distance varies from 0.7 m to 7.4 m. A strong linear \ncorrelation between the beat frequency and the target distance is observed. The slope of the linear fit is around 20.54 \nkHz/m, which is in line with the chirp slope of \u223c 3 MHz/\u00b5s. It is worth noting that the intercept at the frequency \naxis comes from the fixed fiber length difference. The chirp slope can be further increased by using FMCW PLL ICs \n[15], in order to speed up the ranging operation. \n \n4.  Conclusion \nIn conclusion, we demonstrate a hybrid solid-state beam scanner based on the Si3N4 switching array. The \ncombination of the edge emitter and the external transmission grating improves the beam quality as well as the \noptical emission efficiency. Besides, no prism lens with special designs and mechanical moving components exist in \nthe easily implemented beam scanner. Two-dimensional beam steering with a FOV of 14.3\u00b0 \u00d7 9.9\u00b0 is achieved by \nswitch toggling and wavelength tuning. Furthermore, FMCW ranging operation up to 7.4 m is also presented by \nusing the Si3N4 switching array as the transmitter. Our measurements indicate that the proposed hybrid solid-state \nbeam scanner is a scalable and flexible solution for the next-generation FMCW LiDAR. \n \n5.  References \n \n[1] D. N. Hutchison, J. Sun, J. K. Doylend, R. Kumar, J. Heck, W. Kim, C. T. Phare, A. Feshali, and H. Rong, \u201cHigh-resolution aliasing-free \noptical beam steering\u201d, Optica 3, 887\u2013890 (2016). \n[2] H. Ito, Y. Kusunoki, J. Maeda, D. Akiyama, N. Kodama, H. Abe, R. Tetsuya, and T. Baba, \u201cWide beam steering by slow-light waveguide \ngratings and a prism lens\u201d, Optica 7, 47\u201352 (2020). \n[3] J. Park, B. G. Jeong, S. I. Kim, D. Lee, J. Kim, C. Shin, C. B. Lee, T. Otsuka, J. Kyoung, S. Kim, K.-Y. Yang, Y.-Y. Park, J. Lee, I. Hwang, J. \nJang, S. H. Song, M. L. Brongersma, K. Ha, S.-W. Hwang, H. Choo, and B. L. Choi, \u201cAll-solid-state spatial light modulator with independent \nphase and amplitude control for three-dimensional LiDAR applications\u201d, Nat. Nanotechnol. 16, 69\u201376 (2021). \n[4] R. Li, S. Hu, X. Gu, and F. Koyama, \u201cSolid-state slow-light beam scanner with ultra-large field of view and high resolution\u201d, J. Light. \nTechnol. 40, 1855\u20131861 (2022). \n[5] C. V. Poulton, M. J. Byrd, P. Russo, E. Timurdogan, M. Khandaker, D. Vermeulen, and M. R. Watts, \u201cLong-range LiDAR and free-space \ndata communication with high-performance optical phased arrays\u201d, IEEE J. Sel. Top. Quantum Electron. 25, 1\u20138 (2019). \n[6] Y. Li, B. Chen, Q. Na, Q. Xie, M. Tao, L. Zhang, Z. Zhi, Y. Li, X. Liu, X. Luo, G. Lo, F. Gao, X. Li, and J. Song, \u201cWide-steering-angle high-\nresolution optical phased array\u201d, Photon. Res. 9, 2511\u20132518 (2021). \n[7] W. Xu, Y. Guo, X. Li, C. Liu, L. Lu, J. Chen, and L. Zhou, \u201cFully integrated solid-state lidar transmitter on a multi-layer silicon-nitride-on-\nsilicon photonic platform\u201d, J. Light. Technol. pp. 1\u201310 (2022). \n[8] T. Komljenovic and P. Pintus, \u201cOn-chip calibration and control of optical phased arrays\u201d, Opt. Express 26, 3199\u20133210 (2018). \n[9] X. Zhang, K. Kwon, J. Henriksson, J. Luo, and M. C. Wu, \u201cA large-scale microelectromechanical-systems-based silicon photonics LiDAR\u201d, \nNature 603, 253\u2013258 (2022). \n[10] C. Rogers, A. Y. Piggott, D. J. Thomson, R. F. Wiser, I. E. Opris, S. A. Fortune, A. J. Compston, A. Gondarenko, F. Meng, X. Chen, G. T. \nReed, and R. Nicolaescu, \u201cA universal 3D imaging sensor on a silicon photonics platform\u201d, Nature 590, 256\u2013261 (2021). \n[11] F. Eltes, C. Mai, D. Caimi, M. Kroh, Y. Popoff, G. Winzer, D. Petousi, S. Lischke, J. E. Ortmann, L. Czornomaz, L. Zimmermann, J. Fom-\npeyrine, and S. Abel, \u201cA BaTiO3-based electro-optic Pockels modulator monolithically integrated on an advanced silicon photonics platform\u201d, J. \nLight. Technol. 37, 1456\u20131462 (2019). \n[12] K. Alexander, J. P. George, J. Verbist, K. Neyts, B. Kuyken, D. Van Thourhout, and J. Beeckman, \u201cNanophotonic Pockels modulators on a \nsilicon nitride platform\u201d, Nat. Commun. 9, 3444 (2018). \n[13] C. Li, X. Cao, K. Wu, G. Qiu, M. Cai, G. Zhang, X. Li, and J. Chen, \u201cBlind zone-suppressed hybrid beam steering for solid-state LiDAR\u201d, \nPhoton. Res. 9, 1871\u20131880 (2021). \n[14] J. Riemensberger, A. Lukashchuk, M. Karpov, W. Weng, E. Lucas, J. Liu, and T. J. Kippenberg, \u201cMassively parallel coherent laser ranging \nusing a soliton microcomb\u201d, Nature 581, 164\u2013170 (2020). \n[15] H. Shanan, D. Dalton, V. Chillara, and P. Dato, \u201cA 9-to-12GHz coupled-RTWO FMCW ADPLL with 97fs rms jitter, -120dBc/Hz PN at \n1MHz offset, and with retrace time of 12.5 ns and 2 \u03bcs chirp settling time\u201d, in 2022 IEEE International Solid- State Circuits Conference (ISSCC), \nvol. 65 (2022), pp. 146\u2013148. \nM3F.1\nOFC 2023 \u00a9 Optica Publishing Group 2023\n\n\nResponse: single_article: True\ntopic_photonic: True\ncomponents_list:\n  - a 1x32 Si3N4 switching array with 32 channels and an overall footprint of 2.2 mm \u00d7 10 mm\n  - a 1x1 grating coupler for light coupling into the chip\n  - a 1x32 cascaded Si3N4 MZI switch array with thermo-optics phase shifters\n  - a 1x32 edge emitter with etched facet inverse tapers and a tip width of 300 nm\n  - a 1x1 blazed grating for beam steering\n  - a 1x1 aspherical lens with f = 8.0 mm and NA = 0.5 for beam collimation\n  - a 1x1 diffraction transmission grating with 966.18 lines/mm for beam alignment\n  - a 1x1 45\u00b0 aluminum-coated mirror for beam deflection",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "LLMCall function forward",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "69",
    "funcName": "forward",
    "created": "1725621096.9528534",
    "msecs": "952.0",
    "relativeCreated": "1143643.7196731567",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "text": "System:You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback.\nQuery: single_article: True\ntopic_photonic: True\ncomponents_list:\n  - a 1x32 Si3N4 switching array with 32 channels and an overall footprint of 2.2 mm \u00d7 10 mm\n  - a 1x1 grating coupler for light coupling into the chip\n  - a 1x32 cascaded Si3N4 MZI switch array with thermo-optics phase shifters\n  - a 1x32 edge emitter with etched facet inverse tapers and a tip width of 300 nm\n  - a 1x1 blazed grating for beam steering\n  - a 1x1 aspherical lens with f = 8.0 mm and NA = 0.5 for beam collimation\n  - a 1x1 diffraction transmission grating with 966.18 lines/mm for beam alignment\n  - a 1x1 45\u00b0 aluminum-coated mirror for beam deflection\nResponse: - The list includes both on-chip and off-chip components, which violates the requirement to only represent photonic components on the chip.\n- The components such as the aspherical lens, diffraction transmission grating, and aluminum-coated mirror are off-chip components and should not be included.\n- The YAML file does not follow the provided template strictly as it includes off-chip components.\n- The on-chip photonic components listed (e.g., Si3N4 switching array, grating coupler, MZI switch array, edge emitter) are accurately represented.\n- No additional on-chip photonic components appear to be missing based on the provided information.\n\nConcise feedback: The YAML file includes off-chip components and should be revised to only list on-chip photonic components.",
    "message": "LLMCall function forward"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm prompt",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "209",
    "funcName": "_backward_through_llm_base",
    "created": "1725621096.953821",
    "msecs": "953.0",
    "relativeCreated": "1143644.6871757507",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "You will give feedback to a variable with the following role: <ROLE> The yaml file to optimize </ROLE>. Here is an evaluation of the variable using a language model:\n\n<LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - a 1x32 Si3N4 switching array with 32 channels and an overall footprint of 2.2 mm \u00d7 10 mm\n  - a 1x1 grating coupler for light coupling into the chip\n  - a 1x32 cascaded Si3N4 MZI switch array with thermo-optics phase shifters\n  - a 1x32 edge emitter with etched facet inverse tapers and a tip width of 300 nm\n  - a 1x1 blazed grating for beam steering\n  - a 1x1 aspherical lens with f = 8.0 mm and NA = 0.5 for beam collimation\n  - a 1x1 diffraction transmission grating with 966.18 lines/mm for beam alignment\n  - a 1x1 45\u00b0 aluminum-coated mirror for beam deflection </LM_INPUT>\n\n<LM_OUTPUT> - The list includes both on-chip and off-chip components, which violates the requirement to only represent photonic components on the chip.\n- The components such as the aspherical lens, diffraction transmission grating, and aluminum-coated mirror are off-chip components and should not be included.\n- The YAML file does not follow the provided template strictly as it includes off-chip components.\n- The on-chip photonic components listed (e.g., Si3N4 switching array, grating coupler, MZI switch array, edge emitter) are accurately represented.\n- No additional on-chip photonic components appear to be missing based on the provided information.\n\nConcise feedback: The YAML file includes off-chip components and should be revised to only list on-chip photonic components. </LM_OUTPUT>\n\n<OBJECTIVE_FUNCTION>Your goal is to give feedback and criticism to the variable given the above evaluation output. Our only goal is to improve the above metric, and nothing else. </OBJECTIVE_FUNCTION>\n\nWe are interested in giving feedback to the The yaml file to optimize for this conversation. Specifically, give feedback to the following span of text:\n\n<VARIABLE> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - a 1x32 Si3N4 switching array (...)  - a 1x1 45\u00b0 aluminum-coated mirror for beam deflection </VARIABLE>\n\nGiven the above history, describe how the The yaml file to optimize could be improved to improve the <OBJECTIVE_FUNCTION>. Be very creative, critical, and intelligent.\n\n",
    "message": "_backward_through_llm prompt"
}
{
    "name": "textgrad",
    "msg": "_backward_through_llm gradient",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\autograd\\llm_ops.py",
    "filename": "llm_ops.py",
    "module": "llm_ops",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "211",
    "funcName": "_backward_through_llm_base",
    "created": "1725621101.0876193",
    "msecs": "87.0",
    "relativeCreated": "1147778.4855365753",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "_backward_through_llm": "To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The evaluation highlights that the list includes off-chip components such as the aspherical lens, diffraction transmission grating, and aluminum-coated mirror. These should be removed to comply with the requirement to only list on-chip photonic components.\n\n2. **Ensure On-Chip Exclusivity**: Double-check each component to ensure it is an on-chip photonic component. For instance, components like grating couplers and MZI switch arrays are typically on-chip, but any ambiguity should be clarified.\n\n3. **Follow the Template Strictly**: The YAML file should strictly adhere to the provided template. Ensure that the format and structure are consistent with the expected template, which might include specific naming conventions or organizational structures.\n\n4. **Verify Completeness**: While the evaluation indicates no additional on-chip components appear to be missing, it is prudent to cross-reference the article to ensure all relevant on-chip photonic components are included. This ensures completeness and accuracy.\n\n5. **Clarify Component Descriptions**: Ensure that the descriptions of the components are clear and unambiguous. For example, specifying that a component is \"on-chip\" in its description can help avoid future confusion.\n\n6. **Consistency in Terminology**: Use consistent terminology for similar components. For example, if \"Si3N4 switching array\" is used, ensure similar components follow the same naming convention.\n\nBy addressing these points, the YAML file will better meet the objective of accurately summarizing the photonic components presented in the input article, focusing exclusively on on-chip components, and adhering to the provided template.",
    "message": "_backward_through_llm gradient"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent prompt for update",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "165",
    "funcName": "_update_prompt",
    "created": "1725621101.0876193",
    "msecs": "87.0",
    "relativeCreated": "1147778.4855365753",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "prompt": "Here is the role of the variable you will improve: <ROLE>The yaml file to optimize</ROLE>.\n\nThe variable is the text within the following span: <VARIABLE> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - a 1x32 Si3N4 switching array (...)  - a 1x1 45\u00b0 aluminum-coated mirror for beam deflection </VARIABLE>\n\nHere is the context and feedback we got for the variable:\n\n<CONTEXT>Here is a conversation:\n\n<CONVERSATION><LM_SYSTEM_PROMPT> You are a smart language model expert in photonic integrated circuits.\nThis YAML file should be an accurate summary of the photonic components presented in the input article.\nEvaluate components_list in YAML based on:\n- it should only represent photonic components on the chip, and not off the chip.\n- does it accurately represent the photonic components?\n- is any photonic component missing?\n- this should be only a list of photonic components.\n- does YAML follow the provided template?\nYou do not propose a new YAML file, only evaluate the existing YAML file critically and give very concise feedback. </LM_SYSTEM_PROMPT>\n\n<LM_INPUT> single_article: True\ntopic_photonic: True\ncomponents_list:\n  - a 1x32 Si3N4 switching array with 32 channels and an overall footprint of 2.2 mm \u00d7 10 mm\n  - a 1x1 grating coupler for light coupling into the chip\n  - a 1x32 cascaded Si3N4 MZI switch array with thermo-optics phase shifters\n  - a 1x32 edge emitter with etched facet inverse tapers and a tip width of 300 nm\n  - a 1x1 blazed grating for beam steering\n  - a 1x1 aspherical lens with f = 8.0 mm and NA = 0.5 for beam collimation\n  - a 1x1 diffraction transmission grating with 966.18 lines/mm for beam alignment\n  - a 1x1 45\u00b0 aluminum-coated mirror for beam deflection </LM_INPUT>\n\n<LM_OUTPUT> - The list includes both on-chip and off-chip components, which violates the requirement to only represent photonic components on the chip.\n- The components such as the aspherical lens, diffraction transmission grating, and aluminum-coated mirror are off-chip components and should not be included.\n- The YAML file does not follow the provided template strictly as it includes off-chip components.\n- The on-chip photonic components listed (e.g., Si3N4 switching array, grating coupler, MZI switch array, edge emitter) are accurately represented.\n- No additional on-chip photonic components appear to be missing based on the provided information.\n\nConcise feedback: The YAML file includes off-chip components and should be revised to only list on-chip photonic components. </LM_OUTPUT>\n\n</CONVERSATION>\n\nThis conversation is potentially part of a larger system. The output is used as response from the language model\n\nHere is the feedback we got for The yaml file to optimize in the conversation:\n\n<FEEDBACK>To improve the YAML file and meet the objective function, consider the following feedback:\n\n1. **Remove Off-Chip Components**: The evaluation highlights that the list includes off-chip components such as the aspherical lens, diffraction transmission grating, and aluminum-coated mirror. These should be removed to comply with the requirement to only list on-chip photonic components.\n\n2. **Ensure On-Chip Exclusivity**: Double-check each component to ensure it is an on-chip photonic component. For instance, components like grating couplers and MZI switch arrays are typically on-chip, but any ambiguity should be clarified.\n\n3. **Follow the Template Strictly**: The YAML file should strictly adhere to the provided template. Ensure that the format and structure are consistent with the expected template, which might include specific naming conventions or organizational structures.\n\n4. **Verify Completeness**: While the evaluation indicates no additional on-chip components appear to be missing, it is prudent to cross-reference the article to ensure all relevant on-chip photonic components are included. This ensures completeness and accuracy.\n\n5. **Clarify Component Descriptions**: Ensure that the descriptions of the components are clear and unambiguous. For example, specifying that a component is \"on-chip\" in its description can help avoid future confusion.\n\n6. **Consistency in Terminology**: Use consistent terminology for similar components. For example, if \"Si3N4 switching array\" is used, ensure similar components follow the same naming convention.\n\nBy addressing these points, the YAML file will better meet the objective of accurately summarizing the photonic components presented in the input article, focusing exclusively on on-chip components, and adhering to the provided template.</FEEDBACK>\n\n</CONTEXT>\n\nImprove the variable (The yaml file to optimize) using the feedback provided in <FEEDBACK> tags.\nSend the improved variable in the following format:\n\n<IMPROVED_VARIABLE>{the improved variable}</IMPROVED_VARIABLE>\n\nSend ONLY the improved variable between the <IMPROVED_VARIABLE> tags, and nothing else.",
    "message": "TextualGradientDescent prompt for update"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent optimizer response",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "179",
    "funcName": "step",
    "created": "1725621103.4247475",
    "msecs": "424.0",
    "relativeCreated": "1150115.6136989594",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "optimizer.response": "<IMPROVED_VARIABLE>\nsingle_article: True\ntopic_photonic: True\ncomponents_list:\n  - a 1x32 Si3N4 switching array with 32 channels and an overall footprint of 2.2 mm \u00d7 10 mm\n  - a 1x1 grating coupler for light coupling into the chip\n  - a 1x32 cascaded Si3N4 MZI switch array with thermo-optics phase shifters\n  - a 1x32 edge emitter with etched facet inverse tapers and a tip width of 300 nm\n  - a 1x1 blazed grating for beam steering\n</IMPROVED_VARIABLE>",
    "message": "TextualGradientDescent optimizer response"
}
{
    "name": "textgrad",
    "msg": "TextualGradientDescent updated text",
    "args": "()",
    "levelname": "INFO",
    "levelno": "20",
    "pathname": "c:\\Users\\vansari\\Documents\\PhotonicAI\\PhotonEnv\\Lib\\site-packages\\textgrad\\optimizer\\optimizer.py",
    "filename": "optimizer.py",
    "module": "optimizer",
    "exc_info": "None",
    "exc_text": "None",
    "stack_info": "None",
    "lineno": "187",
    "funcName": "step",
    "created": "1725621103.4257472",
    "msecs": "425.0",
    "relativeCreated": "1150116.6133880615",
    "thread": "572",
    "threadName": "MainThread",
    "processName": "MainProcess",
    "process": "2444",
    "parameter.value": "single_article: True\ntopic_photonic: True\ncomponents_list:\n  - a 1x32 Si3N4 switching array with 32 channels and an overall footprint of 2.2 mm \u00d7 10 mm\n  - a 1x1 grating coupler for light coupling into the chip\n  - a 1x32 cascaded Si3N4 MZI switch array with thermo-optics phase shifters\n  - a 1x32 edge emitter with etched facet inverse tapers and a tip width of 300 nm\n  - a 1x1 blazed grating for beam steering",
    "message": "TextualGradientDescent updated text"
}
